name: Weekly SEO Learning Cycle (DISABLED - Use SEO Learning Flywheel instead)

# DISABLED: This workflow is superseded by seo-flywheel.yml which provides
# comprehensive 8-phase automation. Keeping file for reference only.

on:
  workflow_dispatch: # Manual trigger only - schedule disabled

jobs:
  seo-learning:
    runs-on: ubuntu-latest
    timeout-minutes: 30

    steps:
      - name: Run SEO Learning Analysis
        run: |
          echo "=== Starting Weekly SEO Learning Cycle ==="
          echo "Timestamp: $(date)"
          echo ""

          # 1. Check system status
          echo "ðŸ“Š Checking SEO Learning System Status..."
          curl -s "https://www.chrisdavidsalon.com/api/seo-learning?action=status" | jq '.'
          echo ""

          # 2. Get current recommendations
          echo "ðŸŽ¯ Fetching Current Recommendations..."
          curl -s "https://www.chrisdavidsalon.com/api/seo-learning?action=recommendations" | jq '.'
          echo ""

          # 3. Check authority scores for all sites
          echo "ðŸ† Checking Authority Scores..."
          curl -s "https://www.chrisdavidsalon.com/api/authority-score?competitors=true" | jq '.data | {main_site: {domain: .all_results[0].domain, pagerank: .all_results[0].pagerank_decimal}, microsites: [.all_results[1], .all_results[2], .all_results[3]] | map({domain, pagerank: .pagerank_decimal})}'
          echo ""

          # 4. Check GA4 traffic data
          echo "ðŸ“ˆ Checking Traffic Data..."
          curl -s "https://www.chrisdavidsalon.com/api/ga4-analytics?type=overview" | jq '{sessions: .data.sessions, users: .data.activeUsers, pageviews: .data.pageViews}'
          echo ""

          # 5. Check competitors
          echo "ðŸª Checking Competitor Data..."
          curl -s "https://www.chrisdavidsalon.com/api/competitors" | jq '.data.competitors | map({name, rating, reviews}) | .[0:5]'
          echo ""

      - name: Ping Sitemaps for Indexing
        run: |
          echo "ðŸ”„ Pinging sitemaps for reindexing..."
          curl -s "https://www.chrisdavidsalon.com/sitemap.xml" > /dev/null && echo "âœ“ chrisdavidsalon.com"
          curl -s "https://bestsalondelray.com/sitemap.xml" > /dev/null && echo "âœ“ bestsalondelray.com"
          curl -s "https://www.bestdelraysalon.com/sitemap.xml" > /dev/null && echo "âœ“ bestdelraysalon.com"
          curl -s "https://bestsalonpalmbeach.com/sitemap.xml" > /dev/null && echo "âœ“ bestsalonpalmbeach.com"

      - name: Generate Weekly Summary
        run: |
          echo ""
          echo "=== Weekly SEO Learning Cycle Complete ==="
          echo "Completed: $(date)"
          echo ""
          echo "ðŸ“‹ Key Actions:"
          echo "  1. âœ… Checked system status"
          echo "  2. âœ… Retrieved current recommendations"
          echo "  3. âœ… Checked authority scores"
          echo "  4. âœ… Verified traffic data"
          echo "  5. âœ… Reviewed competitor positions"
          echo "  6. âœ… Pinged sitemaps"
          echo ""
          echo "ðŸ”— Admin Dashboard: https://www.chrisdavidsalon.com/admin/seo-learning.html"
          echo "ðŸ”— Microsites Dashboard: https://www.chrisdavidsalon.com/admin/microsites.html"
