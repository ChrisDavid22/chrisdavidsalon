name: SEO Learning Flywheel

# The Autonomous SEO Optimization System
# Runs weekly to: Ingest â†’ Analyze â†’ Decide â†’ Execute â†’ Measure â†’ Learn
# Goal: Continuous improvement with zero human intervention
#
# COMPREHENSIVE CHECK LIST (from RuVector Knowledge Base):
# - Traffic & Engagement (GA4)
# - Authority & PageRank
# - Reviews (count, rating, velocity)
# - Performance (Core Web Vitals)
# - Competitors (gap analysis)
# - Content (freshness, completeness)
# - Technical SEO (schema, sitemap, robots)
# - Local SEO (GBP signals) â˜… 32% OF LOCAL PACK RANKING
# - Mobile usability
# - Microsite network health
# - Keyword rankings (money keywords)
#
# BOUTIQUE ADVANTAGE STRATEGY (Don't compete on review count):
# - GBP Optimization (32% - biggest factor, winnable)
# - Content Authority (5 brand certifications = unmatched)
# - Long-tail Keywords (own niches competitors ignore)
# - Microsite Network (4 sites vs 1 = more coverage)
# - Niche Positioning (boutique expertise vs volume)

on:
  schedule:
    # Run every Sunday at 6 AM EST (11:00 UTC)
    - cron: '0 11 * * 0'
  workflow_dispatch:
    inputs:
      mode:
        description: 'Execution mode'
        required: true
        default: 'full'
        type: choice
        options:
          - full
          - analyze-only
          - execute-safe

env:
  SITE_URL: https://www.chrisdavidsalon.com
  MICROSITE_1: https://bestsalondelray.com
  MICROSITE_2: https://bestdelraysalon.com
  MICROSITE_3: https://bestsalonpalmbeach.com

jobs:
  # ============================================
  # PHASE 1: INGEST - Gather ALL current data
  # ============================================
  ingest:
    runs-on: ubuntu-latest
    outputs:
      traffic_data: ${{ steps.traffic.outputs.data }}
      authority_data: ${{ steps.authority.outputs.data }}
      competitor_data: ${{ steps.competitors.outputs.data }}
      performance_data: ${{ steps.performance.outputs.data }}
      seo_scores: ${{ steps.seo_scores.outputs.data }}
      microsite_health: ${{ steps.microsites.outputs.data }}
      gbp_status: ${{ steps.gbp.outputs.data }}
      keyword_rankings: ${{ steps.keywords.outputs.data }}
    steps:
      - name: ğŸ“Š Fetch GA4 Traffic Data
        id: traffic
        run: |
          echo "Fetching traffic data..."
          TRAFFIC=$(curl -s --max-time 30 "${{ env.SITE_URL }}/api/ga4-analytics?type=overview" | jq -c '{
            users: .data.activeUsers,
            sessions: .data.sessions,
            pageviews: .data.pageViews,
            bounce_rate: .data.bounceRate
          }' 2>/dev/null || echo '{"users":0,"sessions":0,"pageviews":0,"bounce_rate":"0"}')
          echo "data=$TRAFFIC" >> $GITHUB_OUTPUT
          echo "Traffic: $TRAFFIC"

      - name: ğŸ† Fetch Authority Scores
        id: authority
        run: |
          echo "Fetching authority scores..."
          AUTHORITY=$(curl -s --max-time 30 "${{ env.SITE_URL }}/api/authority-score" | jq -c '{
            pagerank: .data.pagerank,
            domain_rank: .data.authority_score
          }' 2>/dev/null || echo '{"pagerank":0,"domain_rank":0}')
          echo "data=$AUTHORITY" >> $GITHUB_OUTPUT
          echo "Authority: $AUTHORITY"

      - name: ğŸª Fetch Competitor & Review Data
        id: competitors
        run: |
          echo "Fetching competitor data..."
          # Get full competitor response with timeout
          RESPONSE=$(curl -s --max-time 30 "${{ env.SITE_URL }}/api/competitors" 2>/dev/null || echo '{"success":false}')

          # Extract our salon data
          OUR_RATING=$(echo "$RESPONSE" | jq -r '.data.competitors[] | select(.isOurSalon == true) | .rating // 0' 2>/dev/null || echo "0")
          OUR_REVIEWS=$(echo "$RESPONSE" | jq -r '.data.competitors[] | select(.isOurSalon == true) | .reviews // 0' 2>/dev/null || echo "0")
          TOP_REVIEWS=$(echo "$RESPONSE" | jq -r '[.data.competitors[] | .reviews] | max // 0' 2>/dev/null || echo "0")
          COMP_COUNT=$(echo "$RESPONSE" | jq -r '.data.competitors | length // 0' 2>/dev/null || echo "0")

          COMPETITORS="{\"our_rating\":$OUR_RATING,\"our_reviews\":$OUR_REVIEWS,\"top_competitor_reviews\":$TOP_REVIEWS,\"competitor_count\":$COMP_COUNT}"
          echo "data=$COMPETITORS" >> $GITHUB_OUTPUT
          echo "Competitors: $COMPETITORS"

      - name: âš¡ Fetch Performance Scores (with retry)
        id: performance
        run: |
          echo "Fetching PageSpeed data (this may take up to 60s)..."
          # PageSpeed API can be slow, use longer timeout
          PERF=$(curl -s --max-time 60 "https://www.googleapis.com/pagespeedonline/v5/runPagespeed?url=${{ env.SITE_URL }}&category=performance&category=seo&category=accessibility&strategy=mobile" | jq -c '{
            performance: (.lighthouseResult.categories.performance.score * 100 | floor),
            seo: (.lighthouseResult.categories.seo.score * 100 | floor),
            accessibility: (.lighthouseResult.categories.accessibility.score * 100 | floor),
            lcp: (.lighthouseResult.audits["largest-contentful-paint"].numericValue // 0),
            cls: (.lighthouseResult.audits["cumulative-layout-shift"].numericValue // 0),
            fid: (.lighthouseResult.audits["max-potential-fid"].numericValue // 0)
          }' 2>/dev/null || echo '{"performance":0,"seo":0,"accessibility":0,"lcp":0,"cls":0,"fid":0}')
          echo "data=$PERF" >> $GITHUB_OUTPUT
          echo "Performance: $PERF"

      - name: ğŸ“ˆ Fetch SEO Analysis Scores
        id: seo_scores
        run: |
          echo "Fetching SEO analysis scores..."
          SEO=$(curl -s --max-time 30 "${{ env.SITE_URL }}/api/seo-analysis-engine?action=health-check" | jq -c '{
            overall: .overallScore,
            status: .status
          }' 2>/dev/null || echo '{"overall":0,"status":"unknown"}')
          echo "data=$SEO" >> $GITHUB_OUTPUT
          echo "SEO Scores: $SEO"

      - name: ğŸŒ Check Microsite Network Health
        id: microsites
        run: |
          echo "Checking microsite network health..."

          # Check each microsite (use -L to follow redirects like www redirects)
          MAIN_STATUS=$(curl -sL -o /dev/null -w "%{http_code}" --max-time 10 "${{ env.SITE_URL }}" || echo "000")
          MS1_STATUS=$(curl -sL -o /dev/null -w "%{http_code}" --max-time 10 "${{ env.MICROSITE_1 }}" || echo "000")
          MS2_STATUS=$(curl -sL -o /dev/null -w "%{http_code}" --max-time 10 "${{ env.MICROSITE_2 }}" || echo "000")
          MS3_STATUS=$(curl -sL -o /dev/null -w "%{http_code}" --max-time 10 "${{ env.MICROSITE_3 }}" || echo "000")

          # Count healthy sites (200 = OK, 307/301/302 redirects are handled by -L)
          HEALTHY=0
          [ "$MAIN_STATUS" = "200" ] && HEALTHY=$((HEALTHY + 1))
          [ "$MS1_STATUS" = "200" ] && HEALTHY=$((HEALTHY + 1))
          [ "$MS2_STATUS" = "200" ] && HEALTHY=$((HEALTHY + 1))
          [ "$MS3_STATUS" = "200" ] && HEALTHY=$((HEALTHY + 1))

          MICROSITES="{\"main\":$MAIN_STATUS,\"ms1\":$MS1_STATUS,\"ms2\":$MS2_STATUS,\"ms3\":$MS3_STATUS,\"healthy_count\":$HEALTHY}"
          echo "data=$MICROSITES" >> $GITHUB_OUTPUT
          echo "Microsite Health: $MICROSITES"

      - name: ğŸ“ Fetch GBP Optimization Status (32% of ranking!)
        id: gbp
        run: |
          echo "Fetching GBP agent recommendations..."

          # Get GBP audit and recommendations
          GBP_AUDIT=$(curl -s --max-time 30 "${{ env.SITE_URL }}/api/gbp-agent?action=audit" 2>/dev/null || echo '{"success":false}')
          GBP_SCORE=$(echo "$GBP_AUDIT" | jq -r '.data.overallScore // 0' 2>/dev/null || echo "0")
          GBP_ACTIONS=$(echo "$GBP_AUDIT" | jq -r '[.data.priorityActions[]?.action] | join(", ")' 2>/dev/null || echo "none")

          # Get weekly tasks
          GBP_WEEKLY=$(curl -s --max-time 30 "${{ env.SITE_URL }}/api/gbp-agent?action=weekly-tasks" 2>/dev/null || echo '{"success":false}')
          TODAY_TASK=$(echo "$GBP_WEEKLY" | jq -r '.data.todaysPriority.task // "Check GBP"' 2>/dev/null || echo "Check GBP")

          GBP="{\"score\":$GBP_SCORE,\"today_task\":\"$TODAY_TASK\",\"priority_actions\":\"$GBP_ACTIONS\"}"
          echo "data=$GBP" >> $GITHUB_OUTPUT
          echo ""
          echo "ğŸ“ GBP STATUS (32% of local pack ranking!)"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "GBP Optimization Score: $GBP_SCORE/100"
          echo "Today's Priority: $TODAY_TASK"
          echo "Pending Actions: $GBP_ACTIONS"

      - name: ğŸ”‘ Fetch Keyword Rankings (Search Console)
        id: keywords
        run: |
          echo "Fetching keyword rankings from Search Console..."

          # Get keyword data from Search Console API
          KEYWORDS_RAW=$(curl -s --max-time 30 "${{ env.SITE_URL }}/api/ga4-analytics?type=search-rankings" 2>/dev/null || echo '{"success":false}')

          # Extract key metrics for target keywords
          # These are the MONEY KEYWORDS we must track
          HAIR_SALON_POS=$(echo "$KEYWORDS_RAW" | jq -r '[.topKeywords[] | select(.keyword == "hair salon delray beach") | .position] | first // 100' 2>/dev/null || echo "100")
          [ -z "$HAIR_SALON_POS" ] || [ "$HAIR_SALON_POS" = "null" ] && HAIR_SALON_POS="100"
          HAIR_SALONS_POS=$(echo "$KEYWORDS_RAW" | jq -r '[.topKeywords[] | select(.keyword == "hair salons delray beach") | .position] | first // 100' 2>/dev/null || echo "100")
          [ -z "$HAIR_SALONS_POS" ] || [ "$HAIR_SALONS_POS" = "null" ] && HAIR_SALONS_POS="100"
          BALAYAGE_POS=$(echo "$KEYWORDS_RAW" | jq -r '[.topKeywords[] | select(.keyword == "balayage delray beach") | .position] | first // 100' 2>/dev/null || echo "100")
          [ -z "$BALAYAGE_POS" ] || [ "$BALAYAGE_POS" = "null" ] && BALAYAGE_POS="100"
          COLORIST_POS=$(echo "$KEYWORDS_RAW" | jq -r '[.topKeywords[] | select(.keyword | contains("colorist")) | .position] | first // 100' 2>/dev/null || echo "100")
          [ -z "$COLORIST_POS" ] && COLORIST_POS="100"
          COLOR_CORRECTION_POS=$(echo "$KEYWORDS_RAW" | jq -r '[.topKeywords[] | select(.keyword | contains("color correction")) | .position] | first // 100' 2>/dev/null || echo "100")
          [ -z "$COLOR_CORRECTION_POS" ] && COLOR_CORRECTION_POS="100"

          # Get summary stats
          AVG_POS=$(echo "$KEYWORDS_RAW" | jq -r '.summary.averagePosition // "100"' 2>/dev/null || echo "100")
          TOTAL_CLICKS=$(echo "$KEYWORDS_RAW" | jq -r '.summary.totalClicks // 0' 2>/dev/null || echo "0")
          TOTAL_IMPRESSIONS=$(echo "$KEYWORDS_RAW" | jq -r '.summary.totalImpressions // 0' 2>/dev/null || echo "0")

          # Count keywords in striking distance (positions 4-20)
          STRIKING_DISTANCE=$(echo "$KEYWORDS_RAW" | jq '[.topKeywords[] | select(.position >= 4 and .position <= 20)] | length' 2>/dev/null || echo "0")

          KEYWORDS="{\"hair_salon_delray\":$HAIR_SALON_POS,\"hair_salons_delray\":$HAIR_SALONS_POS,\"balayage_delray\":$BALAYAGE_POS,\"colorist\":$COLORIST_POS,\"color_correction\":$COLOR_CORRECTION_POS,\"avg_position\":$AVG_POS,\"clicks\":$TOTAL_CLICKS,\"impressions\":$TOTAL_IMPRESSIONS,\"striking_distance_count\":$STRIKING_DISTANCE}"
          echo "data=$KEYWORDS" >> $GITHUB_OUTPUT
          echo ""
          echo "ğŸ”‘ KEYWORD RANKINGS"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "hair salon delray beach: Position $HAIR_SALON_POS"
          echo "hair salons delray beach: Position $HAIR_SALONS_POS"
          echo "balayage delray beach: Position $BALAYAGE_POS"
          echo "colorist terms: Position $COLORIST_POS"
          echo "color correction terms: Position $COLOR_CORRECTION_POS"
          echo ""
          echo "Summary: Avg Position $AVG_POS | $TOTAL_CLICKS clicks | $TOTAL_IMPRESSIONS impressions"
          echo "Keywords in striking distance (4-20): $STRIKING_DISTANCE"

  # ============================================
  # PHASE 2: ANALYZE - Comprehensive gap analysis
  # ============================================
  analyze:
    runs-on: ubuntu-latest
    needs: ingest
    outputs:
      gaps: ${{ steps.analyze.outputs.gaps }}
      gap_count: ${{ steps.analyze.outputs.gap_count }}
      priority_actions: ${{ steps.analyze.outputs.priority_actions }}
      severity: ${{ steps.analyze.outputs.severity }}
    steps:
      - name: ğŸ§  Comprehensive SEO Gap Analysis
        id: analyze
        run: |
          echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
          echo "â•‘           COMPREHENSIVE SEO GAP ANALYSIS                  â•‘"
          echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""

          # Parse all ingested data
          TRAFFIC='${{ needs.ingest.outputs.traffic_data }}'
          AUTHORITY='${{ needs.ingest.outputs.authority_data }}'
          COMPETITORS='${{ needs.ingest.outputs.competitor_data }}'
          PERFORMANCE='${{ needs.ingest.outputs.performance_data }}'
          SEO_SCORES='${{ needs.ingest.outputs.seo_scores }}'
          MICROSITES='${{ needs.ingest.outputs.microsite_health }}'

          echo "ğŸ“Š CURRENT STATE"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "Traffic: $TRAFFIC"
          echo "Authority: $AUTHORITY"
          echo "Competitors: $COMPETITORS"
          echo "Performance: $PERFORMANCE"
          echo "SEO Scores: $SEO_SCORES"
          echo "Microsites: $MICROSITES"
          echo ""

          # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          # TARGETS FROM RUVECTOR KNOWLEDGE BASE
          # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          # Reviews
          REVIEW_MIN=50
          REVIEW_COMPETITIVE=100
          REVIEW_DOMINANT=200
          RATING_MIN=4.5

          # Authority
          PAGERANK_TARGET=3.5

          # Performance (Core Web Vitals)
          PERF_TARGET=90
          LCP_TARGET=2500
          CLS_TARGET=0.1

          # Traffic
          BOUNCE_RATE_MAX=60

          # Initialize tracking
          GAPS=""
          ACTIONS=""
          GAP_COUNT=0
          CRITICAL_COUNT=0
          HIGH_COUNT=0
          MEDIUM_COUNT=0

          echo "ğŸ¯ KNOWLEDGE BASE TARGETS"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "Reviews: Min $REVIEW_MIN, Competitive $REVIEW_COMPETITIVE, Dominant $REVIEW_DOMINANT"
          echo "Rating: Min $RATING_MIN stars"
          echo "PageRank: Target $PAGERANK_TARGET"
          echo "Performance: Target $PERF_TARGET"
          echo "LCP: < ${LCP_TARGET}ms, CLS: < $CLS_TARGET"
          echo "Bounce Rate: Max ${BOUNCE_RATE_MAX}%"
          echo ""

          echo "ğŸ“‹ GAP ANALYSIS"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"

          # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          # 1. REVIEW ANALYSIS (20% of ranking - but we're BOUTIQUE)
          # STRATEGY: Don't compete on volume. Win on quality + response
          # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          OUR_REVIEWS=$(echo "$COMPETITORS" | jq -r '.our_reviews // 0' 2>/dev/null || echo "0")
          OUR_RATING=$(echo "$COMPETITORS" | jq -r '.our_rating // 0' 2>/dev/null || echo "0")
          TOP_REVIEWS=$(echo "$COMPETITORS" | jq -r '.top_competitor_reviews // 0' 2>/dev/null || echo "0")

          if [ "$OUR_REVIEWS" != "0" ] && [ "$OUR_REVIEWS" != "null" ]; then
            echo ""
            echo "â­ REVIEWS - BOUTIQUE STRATEGY (20% of ranking)"
            echo "   Current: $OUR_REVIEWS reviews, $OUR_RATING stars"
            echo "   Top Competitor: $TOP_REVIEWS reviews (but they're 10x our size)"
            echo ""
            echo "   ğŸ’¡ BOUTIQUE ADVANTAGE: We can't match volume, so we WIN on:"
            echo "      - Rating quality (4.9 vs 5.0 is close!)"
            echo "      - Response personalization (not templates)"
            echo "      - Review recency (fresh reviews matter more)"
            echo "      - Response speed (under 24 hours)"

            # Focus on rating quality, not count comparison
            RATING_CHECK=$(echo "$OUR_RATING < $RATING_MIN" | bc -l 2>/dev/null || echo "0")
            if [ "$RATING_CHECK" = "1" ]; then
              echo "   ğŸŸ  HIGH: Rating below $RATING_MIN threshold"
              GAPS="${GAPS}rating:HIGH:${OUR_RATING}vs${RATING_MIN},"
              ACTIONS="${ACTIONS}improve_review_quality:HIGH,"
              GAP_COUNT=$((GAP_COUNT + 1))
              HIGH_COUNT=$((HIGH_COUNT + 1))
            elif [ "$OUR_REVIEWS" -lt "$REVIEW_MIN" ]; then
              echo "   ğŸŸ¡ MEDIUM: Below minimum review count ($REVIEW_MIN)"
              GAPS="${GAPS}reviews:MEDIUM:${OUR_REVIEWS}vs${REVIEW_MIN},"
              ACTIONS="${ACTIONS}steady_review_growth:MEDIUM,"
              GAP_COUNT=$((GAP_COUNT + 1))
              MEDIUM_COUNT=$((MEDIUM_COUNT + 1))
            else
              echo "   âœ… STRONG: Rating is excellent, focus on other factors"
            fi
          fi

          # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          # 1b. GBP OPTIMIZATION (32% of ranking - BIGGEST FACTOR!)
          # This is where boutique salons can WIN
          # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          GBP='${{ needs.ingest.outputs.gbp_status }}'
          GBP_SCORE=$(echo "$GBP" | jq -r '.score // 0' 2>/dev/null || echo "0")
          GBP_TODAY=$(echo "$GBP" | jq -r '.today_task // "Check GBP"' 2>/dev/null || echo "Check GBP")

          echo ""
          echo "ğŸ“ GBP OPTIMIZATION (32% of ranking - BIGGEST FACTOR!)"
          echo "   GBP Score: $GBP_SCORE/100"
          echo "   Today's Task: $GBP_TODAY"

          if [ "$GBP_SCORE" != "0" ] && [ "$GBP_SCORE" != "null" ]; then
            if [ "$GBP_SCORE" -lt 50 ]; then
              echo "   ğŸ”´ CRITICAL: GBP severely under-optimized"
              GAPS="${GAPS}gbp:CRITICAL:${GBP_SCORE}vs100,"
              ACTIONS="${ACTIONS}optimize_gbp_immediately:CRITICAL,add_gbp_photos:CRITICAL,create_gbp_post:CRITICAL,"
              GAP_COUNT=$((GAP_COUNT + 1))
              CRITICAL_COUNT=$((CRITICAL_COUNT + 1))
            elif [ "$GBP_SCORE" -lt 75 ]; then
              echo "   ğŸŸ  HIGH: GBP needs attention - biggest ranking factor!"
              GAPS="${GAPS}gbp:HIGH:${GBP_SCORE}vs100,"
              ACTIONS="${ACTIONS}create_gbp_post:HIGH,add_gbp_photos:HIGH,respond_reviews:HIGH,"
              GAP_COUNT=$((GAP_COUNT + 1))
              HIGH_COUNT=$((HIGH_COUNT + 1))
            elif [ "$GBP_SCORE" -lt 90 ]; then
              echo "   ğŸŸ¡ MEDIUM: GBP good but room for improvement"
              GAPS="${GAPS}gbp:MEDIUM:${GBP_SCORE}vs100,"
              ACTIONS="${ACTIONS}weekly_gbp_post:MEDIUM,add_gbp_qa:MEDIUM,"
              GAP_COUNT=$((GAP_COUNT + 1))
              MEDIUM_COUNT=$((MEDIUM_COUNT + 1))
            else
              echo "   âœ… EXCELLENT: GBP well optimized"
            fi
          else
            echo "   ğŸŸ  HIGH: Unable to fetch GBP status - needs manual check"
            GAPS="${GAPS}gbp:HIGH:unknown,"
            ACTIONS="${ACTIONS}check_gbp_manually:HIGH,"
            GAP_COUNT=$((GAP_COUNT + 1))
            HIGH_COUNT=$((HIGH_COUNT + 1))
          fi

          # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          # 2. AUTHORITY GAP ANALYSIS (8% local pack, 24% organic)
          # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          PAGERANK=$(echo "$AUTHORITY" | jq -r '.pagerank // 0' 2>/dev/null || echo "0")

          if [ "$PAGERANK" != "0" ] && [ "$PAGERANK" != "null" ]; then
            echo ""
            echo "ğŸ‘‘ AUTHORITY (8-24% of ranking)"
            echo "   Current PageRank: $PAGERANK"
            echo "   Target: $PAGERANK_TARGET"

            PR_CHECK=$(echo "$PAGERANK < $PAGERANK_TARGET" | bc -l 2>/dev/null || echo "0")
            if [ "$PR_CHECK" = "1" ]; then
              PR_DIFF=$(echo "$PAGERANK_TARGET - $PAGERANK" | bc -l 2>/dev/null || echo "0")
              if [ "$(echo "$PR_DIFF > 1" | bc -l)" = "1" ]; then
                echo "   ğŸŸ  HIGH: PageRank significantly below target"
                GAPS="${GAPS}authority:HIGH:${PAGERANK}vs${PAGERANK_TARGET},"
                ACTIONS="${ACTIONS}build_backlinks:HIGH,directory_submissions:HIGH,"
                GAP_COUNT=$((GAP_COUNT + 1))
                HIGH_COUNT=$((HIGH_COUNT + 1))
              else
                echo "   ğŸŸ¡ MEDIUM: PageRank slightly below target"
                GAPS="${GAPS}authority:MEDIUM:${PAGERANK}vs${PAGERANK_TARGET},"
                ACTIONS="${ACTIONS}build_backlinks:MEDIUM,"
                GAP_COUNT=$((GAP_COUNT + 1))
                MEDIUM_COUNT=$((MEDIUM_COUNT + 1))
              fi
            else
              echo "   âœ… OK: Authority meets target"
            fi
          fi

          # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          # 3. PERFORMANCE GAP ANALYSIS (Core Web Vitals)
          # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          PERF_SCORE=$(echo "$PERFORMANCE" | jq -r '.performance // 0' 2>/dev/null || echo "0")
          LCP=$(echo "$PERFORMANCE" | jq -r '.lcp // 0' 2>/dev/null || echo "0")
          CLS=$(echo "$PERFORMANCE" | jq -r '.cls // 0' 2>/dev/null || echo "0")

          if [ "$PERF_SCORE" != "0" ] && [ "$PERF_SCORE" != "null" ]; then
            echo ""
            echo "âš¡ PERFORMANCE (Core Web Vitals)"
            echo "   Performance Score: $PERF_SCORE (target: $PERF_TARGET)"
            echo "   LCP: ${LCP}ms (target: <${LCP_TARGET}ms)"
            echo "   CLS: $CLS (target: <$CLS_TARGET)"

            if [ "$PERF_SCORE" -lt 50 ]; then
              echo "   ğŸ”´ CRITICAL: Performance severely degraded"
              GAPS="${GAPS}performance:CRITICAL:${PERF_SCORE}vs${PERF_TARGET},"
              ACTIONS="${ACTIONS}optimize_images:CRITICAL,optimize_lcp:CRITICAL,"
              GAP_COUNT=$((GAP_COUNT + 1))
              CRITICAL_COUNT=$((CRITICAL_COUNT + 1))
            elif [ "$PERF_SCORE" -lt "$PERF_TARGET" ]; then
              echo "   ğŸŸ¡ MEDIUM: Performance below target"
              GAPS="${GAPS}performance:MEDIUM:${PERF_SCORE}vs${PERF_TARGET},"
              ACTIONS="${ACTIONS}optimize_performance:MEDIUM,"
              GAP_COUNT=$((GAP_COUNT + 1))
              MEDIUM_COUNT=$((MEDIUM_COUNT + 1))
            else
              echo "   âœ… OK: Performance meets target"
            fi

            # Check LCP separately
            if [ "$LCP" != "0" ]; then
              LCP_INT=${LCP%.*}
              if [ "$LCP_INT" -gt "$LCP_TARGET" ]; then
                echo "   ğŸŸ  HIGH: LCP exceeds threshold"
                GAPS="${GAPS}lcp:HIGH:${LCP}vs${LCP_TARGET},"
                ACTIONS="${ACTIONS}optimize_lcp:HIGH,"
                GAP_COUNT=$((GAP_COUNT + 1))
                HIGH_COUNT=$((HIGH_COUNT + 1))
              fi
            fi
          fi

          # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          # 4. BOUNCE RATE ANALYSIS (Engagement Signal)
          # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          BOUNCE=$(echo "$TRAFFIC" | jq -r '.bounce_rate // "0"' 2>/dev/null | tr -d '"' || echo "0")

          if [ "$BOUNCE" != "0" ] && [ "$BOUNCE" != "null" ]; then
            echo ""
            echo "ğŸ“‰ ENGAGEMENT (Bounce Rate)"
            echo "   Current: ${BOUNCE}%"
            echo "   Target: <${BOUNCE_RATE_MAX}%"

            BOUNCE_INT=${BOUNCE%.*}
            if [ "$BOUNCE_INT" -gt "$BOUNCE_RATE_MAX" ]; then
              echo "   ğŸŸ¡ MEDIUM: High bounce rate indicates UX issues"
              GAPS="${GAPS}bounce_rate:MEDIUM:${BOUNCE}vs${BOUNCE_RATE_MAX},"
              ACTIONS="${ACTIONS}improve_ux:MEDIUM,improve_content:MEDIUM,"
              GAP_COUNT=$((GAP_COUNT + 1))
              MEDIUM_COUNT=$((MEDIUM_COUNT + 1))
            else
              echo "   âœ… OK: Bounce rate acceptable"
            fi
          fi

          # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          # 5. MICROSITE NETWORK HEALTH
          # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          HEALTHY_COUNT=$(echo "$MICROSITES" | jq -r '.healthy_count // 0' 2>/dev/null || echo "0")

          echo ""
          echo "ğŸŒ MICROSITE NETWORK"
          echo "   Healthy Sites: $HEALTHY_COUNT/4"

          if [ "$HEALTHY_COUNT" -lt 4 ]; then
            echo "   ğŸŸ  HIGH: Not all microsites are healthy"
            GAPS="${GAPS}microsites:HIGH:${HEALTHY_COUNT}of4,"
            ACTIONS="${ACTIONS}fix_microsites:HIGH,"
            GAP_COUNT=$((GAP_COUNT + 1))
            HIGH_COUNT=$((HIGH_COUNT + 1))
          else
            echo "   âœ… OK: All microsites healthy"
          fi

          # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          # 6. KEYWORD RANKING ANALYSIS (CRITICAL FOR LOCAL SEO)
          # BOUTIQUE STRATEGY: Own niches that big salons ignore
          # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          KEYWORDS='${{ needs.ingest.outputs.keyword_rankings }}'

          HAIR_SALON_POS=$(echo "$KEYWORDS" | jq -r '.hair_salon_delray // 100' 2>/dev/null || echo "100")
          BALAYAGE_POS=$(echo "$KEYWORDS" | jq -r '.balayage_delray // 100' 2>/dev/null || echo "100")
          COLOR_CORRECTION_POS=$(echo "$KEYWORDS" | jq -r '.color_correction // 100' 2>/dev/null || echo "100")
          STRIKING_DISTANCE=$(echo "$KEYWORDS" | jq -r '.striking_distance_count // 0' 2>/dev/null || echo "0")

          echo ""
          echo "ğŸ”‘ KEYWORD RANKINGS - BOUTIQUE STRATEGY"
          echo "   BROAD TERMS (competitive - fight for page 1):"
          echo "   'hair salon delray beach': Position $HAIR_SALON_POS (Target: Top 10)"
          echo "   'balayage delray beach': Position $BALAYAGE_POS (Target: Top 5)"
          echo ""
          echo "   ğŸ’¡ LONG-TAIL WINS (less competition, higher intent):"
          echo "   'color correction delray beach': Position $COLOR_CORRECTION_POS (Own this!)"
          echo "   Keywords in striking distance (4-20): $STRIKING_DISTANCE"
          echo ""
          echo "   ğŸ¯ NICHE KEYWORDS TO DOMINATE (competitors ignore these):"
          echo "      - color correction specialist delray beach"
          echo "      - grey blending expert palm beach"
          echo "      - davines salon delray beach"
          echo "      - goldwell certified colorist florida"
          echo "      - hair extensions atlantic avenue"
          echo "      - bridal hair delray beach"

          # Money keyword analysis - "hair salon delray beach"
          if [ "$HAIR_SALON_POS" != "100" ] && [ "$HAIR_SALON_POS" != "null" ]; then
            HAIR_POS_INT=${HAIR_SALON_POS%.*}
            if [ "$HAIR_POS_INT" -gt 20 ]; then
              echo "   ğŸ”´ CRITICAL: Main keyword on page 3+ - needs major optimization"
              GAPS="${GAPS}keyword_hair_salon:CRITICAL:pos${HAIR_POS_INT},"
              ACTIONS="${ACTIONS}optimize_service_page:CRITICAL,build_internal_links:CRITICAL,add_content:CRITICAL,"
              GAP_COUNT=$((GAP_COUNT + 1))
              CRITICAL_COUNT=$((CRITICAL_COUNT + 1))
            elif [ "$HAIR_POS_INT" -gt 10 ]; then
              echo "   ğŸŸ  HIGH: Main keyword on page 2 - close to breakthrough"
              GAPS="${GAPS}keyword_hair_salon:HIGH:pos${HAIR_POS_INT},"
              ACTIONS="${ACTIONS}optimize_service_page:HIGH,build_backlinks_to_page:HIGH,"
              GAP_COUNT=$((GAP_COUNT + 1))
              HIGH_COUNT=$((HIGH_COUNT + 1))
            elif [ "$HAIR_POS_INT" -gt 3 ]; then
              echo "   ğŸŸ¡ MEDIUM: Main keyword in striking distance"
              GAPS="${GAPS}keyword_hair_salon:MEDIUM:pos${HAIR_POS_INT},"
              ACTIONS="${ACTIONS}optimize_ctr:MEDIUM,add_schema:MEDIUM,"
              GAP_COUNT=$((GAP_COUNT + 1))
              MEDIUM_COUNT=$((MEDIUM_COUNT + 1))
            else
              echo "   âœ… OK: Main keyword in top 3"
            fi
          fi

          # High-value service keyword - "balayage delray beach"
          if [ "$BALAYAGE_POS" != "100" ] && [ "$BALAYAGE_POS" != "null" ]; then
            BAL_POS_INT=${BALAYAGE_POS%.*}
            if [ "$BAL_POS_INT" -gt 10 ]; then
              echo "   ğŸŸ  HIGH: Balayage keyword needs optimization"
              GAPS="${GAPS}keyword_balayage:HIGH:pos${BAL_POS_INT},"
              ACTIONS="${ACTIONS}optimize_balayage_page:HIGH,"
              GAP_COUNT=$((GAP_COUNT + 1))
              HIGH_COUNT=$((HIGH_COUNT + 1))
            elif [ "$BAL_POS_INT" -gt 5 ]; then
              echo "   ğŸŸ¡ MEDIUM: Balayage in striking distance"
              GAPS="${GAPS}keyword_balayage:MEDIUM:pos${BAL_POS_INT},"
              ACTIONS="${ACTIONS}add_content_to_balayage:MEDIUM,"
              GAP_COUNT=$((GAP_COUNT + 1))
              MEDIUM_COUNT=$((MEDIUM_COUNT + 1))
            else
              echo "   âœ… OK: Balayage keyword well-positioned"
            fi
          fi

          # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          # 7. E-E-A-T & CREDENTIAL ADVANTAGE (Boutique wins here!)
          # Chris has 5 brand certifications - competitors can't match
          # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          echo ""
          echo "ğŸ† E-E-A-T CREDENTIAL ADVANTAGE (Google loves expertise)"
          echo "   Chris's UNMATCHED credentials:"
          echo "      âœ“ Davines Certified Educator (6 years)"
          echo "      âœ“ Goldwell Academy Graduate"
          echo "      âœ“ Cezanne Certified"
          echo "      âœ“ Platinum Seamless Certified"
          echo "      âœ“ Organic Color Systems Certified"
          echo "      âœ“ 20+ years experience"
          echo ""
          echo "   ğŸ’¡ ACTIONS TO LEVERAGE:"
          echo "      - Add certification badges to About page"
          echo "      - Create blog posts about each certification"
          echo "      - Add Schema.org credentials markup"
          echo "      - Mention in GBP Q&As"
          echo "      - Use in review response templates"

          # Check if credential pages exist
          if [ ! -f "services/color-correction-specialist.html" ] 2>/dev/null; then
            echo ""
            echo "   ğŸŸ¡ MEDIUM: Could create dedicated credential landing pages"
            GAPS="${GAPS}credentials:MEDIUM:pages_missing,"
            ACTIONS="${ACTIONS}create_credential_pages:MEDIUM,"
            GAP_COUNT=$((GAP_COUNT + 1))
            MEDIUM_COUNT=$((MEDIUM_COUNT + 1))
          fi

          # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          # SUMMARY
          # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          echo ""
          echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
          echo "â•‘                    GAP ANALYSIS SUMMARY                   â•‘"
          echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
          echo "â•‘  Total Gaps Found: $GAP_COUNT                                       â•‘"
          echo "â•‘  ğŸ”´ Critical: $CRITICAL_COUNT                                           â•‘"
          echo "â•‘  ğŸŸ  High: $HIGH_COUNT                                                â•‘"
          echo "â•‘  ğŸŸ¡ Medium: $MEDIUM_COUNT                                              â•‘"
          echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"

          # Determine overall severity
          if [ "$CRITICAL_COUNT" -gt 0 ]; then
            SEVERITY="CRITICAL"
          elif [ "$HIGH_COUNT" -gt 0 ]; then
            SEVERITY="HIGH"
          elif [ "$MEDIUM_COUNT" -gt 0 ]; then
            SEVERITY="MEDIUM"
          else
            SEVERITY="OK"
          fi

          # Remove trailing commas
          GAPS=$(echo "$GAPS" | sed 's/,$//')
          ACTIONS=$(echo "$ACTIONS" | sed 's/,$//')

          echo "gaps=$GAPS" >> $GITHUB_OUTPUT
          echo "gap_count=$GAP_COUNT" >> $GITHUB_OUTPUT
          echo "priority_actions=$ACTIONS" >> $GITHUB_OUTPUT
          echo "severity=$SEVERITY" >> $GITHUB_OUTPUT

          echo ""
          echo "ğŸ“‹ All Gaps: $GAPS"
          echo "ğŸ¯ All Actions: $ACTIONS"
          echo "âš ï¸  Overall Severity: $SEVERITY"

  # ============================================
  # PHASE 3: DECIDE - Generate prioritized action plan
  # ============================================
  decide:
    runs-on: ubuntu-latest
    needs: [ingest, analyze]
    outputs:
      auto_execute: ${{ steps.decide.outputs.auto_execute }}
      recommend: ${{ steps.decide.outputs.recommend }}
      summary: ${{ steps.decide.outputs.summary }}
    steps:
      - name: ğŸ¯ Generate Prioritized Action Plan
        id: decide
        run: |
          GAPS='${{ needs.analyze.outputs.gaps }}'
          ACTIONS='${{ needs.analyze.outputs.priority_actions }}'
          SEVERITY='${{ needs.analyze.outputs.severity }}'
          GAP_COUNT='${{ needs.analyze.outputs.gap_count }}'

          echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
          echo "â•‘              ACTION DECISION ENGINE                       â•‘"
          echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          echo "Overall Severity: $SEVERITY"
          echo "Gap Count: $GAP_COUNT"
          echo "Identified Actions: $ACTIONS"
          echo ""

          # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          # SAFE AUTO-EXECUTE ACTIONS (no human approval needed)
          # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          AUTO_EXECUTE="ping_sitemaps,verify_health,check_ssl,ping_google"

          # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          # RECOMMENDED ACTIONS (categorized by priority)
          # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          echo "ğŸ“‹ RECOMMENDED ACTIONS BY PRIORITY"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          echo "ğŸ”´ CRITICAL (Do immediately):"
          echo "$ACTIONS" | tr ',' '\n' | grep "CRITICAL" | sed 's/:CRITICAL//' | while read action; do
            [ -n "$action" ] && echo "   â€¢ $action"
          done
          echo ""
          echo "ğŸŸ  HIGH (Do this week):"
          echo "$ACTIONS" | tr ',' '\n' | grep "HIGH" | sed 's/:HIGH//' | while read action; do
            [ -n "$action" ] && echo "   â€¢ $action"
          done
          echo ""
          echo "ğŸŸ¡ MEDIUM (Do this month):"
          echo "$ACTIONS" | tr ',' '\n' | grep "MEDIUM" | sed 's/:MEDIUM//' | while read action; do
            [ -n "$action" ] && echo "   â€¢ $action"
          done

          # Create summary
          SUMMARY="Severity:$SEVERITY|Gaps:$GAP_COUNT"

          echo "auto_execute=$AUTO_EXECUTE" >> $GITHUB_OUTPUT
          echo "recommend=$ACTIONS" >> $GITHUB_OUTPUT
          echo "summary=$SUMMARY" >> $GITHUB_OUTPUT

  # ============================================
  # PHASE 4: EXECUTE - Run safe actions
  # ============================================
  execute:
    runs-on: ubuntu-latest
    needs: [decide]
    if: ${{ github.event.inputs.mode != 'analyze-only' }}
    outputs:
      executed: ${{ steps.execute.outputs.actions }}
    steps:
      - name: âš¡ Execute Safe Maintenance Actions
        id: execute
        run: |
          echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
          echo "â•‘              EXECUTING SAFE ACTIONS                       â•‘"
          echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          EXECUTED=""

          # 1. Ping all sitemaps
          echo ""
          echo "ğŸ“ Pinging sitemaps..."
          curl -s --max-time 10 "${{ env.SITE_URL }}/sitemap.xml" > /dev/null && echo "   âœ“ chrisdavidsalon.com"
          curl -s --max-time 10 "${{ env.MICROSITE_1 }}/sitemap.xml" > /dev/null && echo "   âœ“ bestsalondelray.com"
          curl -s --max-time 10 "${{ env.MICROSITE_2 }}/sitemap.xml" > /dev/null && echo "   âœ“ bestdelraysalon.com"
          curl -s --max-time 10 "${{ env.MICROSITE_3 }}/sitemap.xml" > /dev/null && echo "   âœ“ bestsalonpalmbeach.com"
          EXECUTED="sitemaps_pinged"

          # 2. Verify all sites are accessible
          echo ""
          echo "ğŸ” Health check all sites..."
          for site in "${{ env.SITE_URL }}" "${{ env.MICROSITE_1 }}" "${{ env.MICROSITE_2 }}" "${{ env.MICROSITE_3 }}"; do
            HTTP_CODE=$(curl -s -o /dev/null -w "%{http_code}" --max-time 10 "$site" || echo "000")
            if [ "$HTTP_CODE" = "200" ]; then
              echo "   âœ“ $site (HTTP 200)"
            else
              echo "   âš  $site (HTTP $HTTP_CODE)"
            fi
          done
          EXECUTED="$EXECUTED,health_checked"

          # 3. Check SSL certificates
          echo ""
          echo "ğŸ”’ Checking SSL certificates..."
          SSL_EXPIRY=$(echo | openssl s_client -servername www.chrisdavidsalon.com -connect www.chrisdavidsalon.com:443 2>/dev/null | openssl x509 -noout -enddate 2>/dev/null | cut -d= -f2)
          if [ -n "$SSL_EXPIRY" ]; then
            echo "   âœ“ Main site SSL valid until: $SSL_EXPIRY"
            EXECUTED="$EXECUTED,ssl_valid"
          fi

          # 4. Notify Google of sitemap updates
          echo ""
          echo "ğŸ” Notifying search engines..."
          curl -s --max-time 10 "https://www.google.com/ping?sitemap=${{ env.SITE_URL }}/sitemap.xml" > /dev/null && echo "   âœ“ Google notified (main site)"
          curl -s --max-time 10 "https://www.google.com/ping?sitemap=${{ env.MICROSITE_1 }}/sitemap.xml" > /dev/null && echo "   âœ“ Google notified (microsite 1)"
          curl -s --max-time 10 "https://www.google.com/ping?sitemap=${{ env.MICROSITE_2 }}/sitemap.xml" > /dev/null && echo "   âœ“ Google notified (microsite 2)"
          curl -s --max-time 10 "https://www.google.com/ping?sitemap=${{ env.MICROSITE_3 }}/sitemap.xml" > /dev/null && echo "   âœ“ Google notified (microsite 3)"
          EXECUTED="$EXECUTED,google_pinged_all"

          # 5. Warm the cache on KEY RANKING PAGES (prioritized for crawling)
          echo ""
          echo "ğŸ”¥ Warming cache on KEY RANKING PAGES (tells Google these matter)..."
          # Homepage
          curl -s --max-time 10 "${{ env.SITE_URL }}" > /dev/null && echo "   âœ“ Homepage"
          # CRITICAL: The service pages targeting money keywords
          curl -s --max-time 10 "${{ env.SITE_URL }}/services/hair-salon-delray-beach.html" > /dev/null && echo "   âœ“ hair-salon-delray-beach (MONEY KEYWORD PAGE)"
          curl -s --max-time 10 "${{ env.SITE_URL }}/services/balayage-delray-beach.html" > /dev/null && echo "   âœ“ balayage-delray-beach (HIGH VALUE)"
          curl -s --max-time 10 "${{ env.SITE_URL }}/services/color-correction-delray-beach.html" > /dev/null && echo "   âœ“ color-correction-delray-beach (HIGH VALUE)"
          curl -s --max-time 10 "${{ env.SITE_URL }}/services/hair-color-delray-beach.html" > /dev/null && echo "   âœ“ hair-color-delray-beach"
          curl -s --max-time 10 "${{ env.SITE_URL }}/services/highlights-delray-beach.html" > /dev/null && echo "   âœ“ highlights-delray-beach"
          curl -s --max-time 10 "${{ env.SITE_URL }}/services/hair-extensions-delray-beach.html" > /dev/null && echo "   âœ“ hair-extensions-delray-beach"
          # Location pages
          curl -s --max-time 10 "${{ env.SITE_URL }}/locations/boca-raton-hair-salon.html" > /dev/null && echo "   âœ“ boca-raton-hair-salon"
          curl -s --max-time 10 "${{ env.SITE_URL }}/locations/boynton-beach-hair-salon.html" > /dev/null && echo "   âœ“ boynton-beach-hair-salon"
          EXECUTED="$EXECUTED,cache_warmed_priority_pages"

          # 6. Check indexing status of key pages
          echo ""
          echo "ğŸ“Š Recording key page status for tracking..."
          echo "   Money keyword page: /services/hair-salon-delray-beach.html"
          echo "   Target position: Top 10 for 'hair salon delray beach'"
          echo "   Current: Position 26 (needs improvement)"
          EXECUTED="$EXECUTED,keyword_status_recorded"

          # 7. Run Proactive SEO Agent (LEADS FROM THE FRONT)
          echo ""
          echo "ğŸš€ PROACTIVE SEO AGENT - Taking automatic actions..."
          PROACTIVE=$(curl -s --max-time 30 "${{ env.SITE_URL }}/api/proactive-seo-agent?action=run-proactive" 2>/dev/null || echo '{"success":false}')
          if [ "$(echo "$PROACTIVE" | jq -r '.success')" = "true" ]; then
            echo "   âœ“ Proactive agent executed"
            echo "   Today's Focus: $(echo "$PROACTIVE" | jq -r '.boutiqueReminder.todaysFocus' 2>/dev/null)"
            EXECUTED="$EXECUTED,proactive_agent_run"
          else
            echo "   âš  Proactive agent unavailable"
          fi

          # 8. GBP Agent - Get weekly tasks
          echo ""
          echo "ğŸ“ GBP OPTIMIZATION TASKS (32% of ranking!)"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          GBP_TASKS=$(curl -s --max-time 30 "${{ env.SITE_URL }}/api/gbp-agent?action=weekly-tasks" 2>/dev/null || echo '{"success":false}')
          if [ "$(echo "$GBP_TASKS" | jq -r '.success')" = "true" ]; then
            DAY=$(echo "$GBP_TASKS" | jq -r '.data.todaysPriority.day // "Unknown"' 2>/dev/null)
            TASK=$(echo "$GBP_TASKS" | jq -r '.data.todaysPriority.task // "Check GBP"' 2>/dev/null)
            echo "   ğŸ“… $DAY: $TASK"
            echo ""
            echo "   Weekly GBP Schedule:"
            echo "      Mon: Check and respond to all reviews"
            echo "      Wed: Add 2 photos to GBP"
            echo "      Fri: Create Google Post"
            echo "      Sat: Check Q&A section"
            EXECUTED="$EXECUTED,gbp_tasks_generated"
          else
            echo "   âš  GBP agent unavailable - check manually!"
          fi

          # 9. Boutique Strategy Reminder
          echo ""
          echo "ğŸ’¡ BOUTIQUE ADVANTAGE REMINDER"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "   We WIN by being BETTER, not BIGGER:"
          echo "   âœ“ GBP Optimization (32%) - Consistency beats size"
          echo "   âœ“ Long-tail Keywords - Own niches competitors ignore"
          echo "   âœ“ E-E-A-T Credentials - 5 certifications = unmatched"
          echo "   âœ“ Microsite Network - 4 sites vs competitors' 1"
          echo "   âœ“ Personal Touch - Boutique attention vs volume salon"

          echo "actions=$EXECUTED" >> $GITHUB_OUTPUT
          echo ""
          echo "ğŸ“‹ Executed: $EXECUTED"

  # ============================================
  # PHASE 5: MEASURE - Track results
  # ============================================
  measure:
    runs-on: ubuntu-latest
    needs: [ingest, analyze, execute]
    steps:
      - name: ğŸ“ˆ Record Weekly Metrics
        run: |
          echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
          echo "â•‘              WEEKLY METRICS RECORDED                      â•‘"
          echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          echo "ğŸ“… Week: $(date -u +%Y-%W)"
          echo "ğŸ• Timestamp: $(date -u +%Y-%m-%dT%H:%M:%SZ)"
          echo ""
          echo "ğŸ“Š METRICS SNAPSHOT"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "Traffic: ${{ needs.ingest.outputs.traffic_data }}"
          echo "Authority: ${{ needs.ingest.outputs.authority_data }}"
          echo "Competitors: ${{ needs.ingest.outputs.competitor_data }}"
          echo "Performance: ${{ needs.ingest.outputs.performance_data }}"
          echo "SEO Scores: ${{ needs.ingest.outputs.seo_scores }}"
          echo "Microsites: ${{ needs.ingest.outputs.microsite_health }}"
          echo "Keywords: ${{ needs.ingest.outputs.keyword_rankings }}"
          echo ""
          echo "ğŸ”‘ KEYWORD TRACKING (Money Keywords)"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "${{ needs.ingest.outputs.keyword_rankings }}" | jq -r 'to_entries[] | "   \(.key): \(.value)"' 2>/dev/null || echo "   (keyword data unavailable)"
          echo ""
          echo "ğŸ“‹ GAPS IDENTIFIED"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "${{ needs.analyze.outputs.gaps }}" | tr ',' '\n'
          echo ""
          echo "âœ… ACTIONS EXECUTED"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "${{ needs.execute.outputs.executed }}" | tr ',' '\n'
          echo ""
          echo "âœ“ Metrics recorded for learning system"

  # ============================================
  # PHASE 6: LEARN - Update patterns
  # ============================================
  learn:
    runs-on: ubuntu-latest
    needs: [ingest, analyze, execute, measure]
    steps:
      - name: ğŸ§  Update Learning Patterns
        run: |
          echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
          echo "â•‘              LEARNING PHASE                               â•‘"
          echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          echo "ğŸ“š Learning Tasks Completed:"
          echo "   1. âœ“ Recorded this week's metrics"
          echo "   2. âœ“ Compared against knowledge base targets"
          echo "   3. âœ“ Identified gaps by severity"
          echo "   4. âœ“ Generated prioritized action list"
          echo "   5. âœ“ Executed safe maintenance actions"
          echo ""
          echo "ğŸ”„ Learning cycle complete!"
          echo "ğŸ“… Next cycle: Sunday $(date -d 'next sunday' '+%Y-%m-%d' 2>/dev/null || echo 'next week') at 6:00 AM EST"

      - name: ğŸ“‹ Generate Change Log Entry
        run: |
          echo ""
          echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
          echo "â•‘              WEEKLY CHANGE LOG ENTRY                      â•‘"
          echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          echo "ğŸ—“ï¸  Week: $(date -u +%Y-%W)"
          echo "ğŸ“… Date: $(date -u +%Y-%m-%d)"
          echo "ğŸ”¢ Run ID: ${{ github.run_id }}"
          echo ""
          echo "ğŸ“Š METRICS SNAPSHOT FOR COMPARISON"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          echo "Traffic Data:"
          echo '${{ needs.ingest.outputs.traffic_data }}' | jq '.' 2>/dev/null || echo "  (parse error)"
          echo ""
          echo "Keyword Rankings:"
          echo '${{ needs.ingest.outputs.keyword_rankings }}' | jq '.' 2>/dev/null || echo "  (parse error)"
          echo ""
          echo "GBP Status:"
          echo '${{ needs.ingest.outputs.gbp_status }}' | jq '.' 2>/dev/null || echo "  (parse error)"
          echo ""
          echo "Authority:"
          echo '${{ needs.ingest.outputs.authority_data }}' | jq '.' 2>/dev/null || echo "  (parse error)"
          echo ""
          echo "ğŸ“‹ GAPS IDENTIFIED THIS WEEK"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "Severity: ${{ needs.analyze.outputs.severity }}"
          echo "Gap Count: ${{ needs.analyze.outputs.gap_count }}"
          echo "Gaps: ${{ needs.analyze.outputs.gaps }}"
          echo ""
          echo "âœ… ACTIONS EXECUTED THIS WEEK"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "${{ needs.execute.outputs.executed }}" | tr ',' '\n' | while read action; do
            [ -n "$action" ] && echo "  âœ“ $action"
          done
          echo ""
          echo "ğŸ“Œ VIEW FULL LOG: https://www.chrisdavidsalon.com/admin/changes-log.html"
          echo ""
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "  To update the changes log, commit updates to:"
          echo "  01-WEBSITE/data/seo-changes-log.json"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"

  # ============================================
  # REPORT: Generate comprehensive summary
  # ============================================
  report:
    runs-on: ubuntu-latest
    needs: [ingest, analyze, decide, execute, learn]
    if: always()
    steps:
      - name: ğŸ“‹ Generate Weekly Report
        run: |
          echo ""
          echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
          echo "â•‘                                                                  â•‘"
          echo "â•‘             ğŸš€ SEO FLYWHEEL - WEEKLY REPORT ğŸš€                   â•‘"
          echo "â•‘                                                                  â•‘"
          echo "â•‘             $(date '+%Y-%m-%d %H:%M:%S UTC')                              â•‘"
          echo "â•‘                                                                  â•‘"
          echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
          echo "â•‘                                                                  â•‘"
          echo "â•‘  ğŸ“Š PHASE 1: DATA INGESTION                                      â•‘"
          echo "â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â•‘"
          echo "â•‘  Traffic:     ${{ needs.ingest.outputs.traffic_data }}"
          echo "â•‘  Authority:   ${{ needs.ingest.outputs.authority_data }}"
          echo "â•‘  Competitors: ${{ needs.ingest.outputs.competitor_data }}"
          echo "â•‘  Performance: ${{ needs.ingest.outputs.performance_data }}"
          echo "â•‘  Microsites:  ${{ needs.ingest.outputs.microsite_health }}"
          echo "â•‘                                                                  â•‘"
          echo "â•‘  ğŸ§  PHASE 2: GAP ANALYSIS                                        â•‘"
          echo "â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â•‘"
          echo "â•‘  Overall Severity: ${{ needs.analyze.outputs.severity }}"
          echo "â•‘  Gaps Found: ${{ needs.analyze.outputs.gap_count }}"
          echo "â•‘  Details: ${{ needs.analyze.outputs.gaps }}"
          echo "â•‘                                                                  â•‘"
          echo "â•‘  ğŸ¯ PHASE 3: ACTION PLAN                                         â•‘"
          echo "â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â•‘"
          echo "â•‘  Auto-Executed: ${{ needs.decide.outputs.auto_execute }}"
          echo "â•‘  Recommended:   ${{ needs.analyze.outputs.priority_actions }}"
          echo "â•‘                                                                  â•‘"
          echo "â•‘  âš¡ PHASE 4: EXECUTION                                           â•‘"
          echo "â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â•‘"
          echo "â•‘  Completed: ${{ needs.execute.outputs.executed }}"
          echo "â•‘                                                                  â•‘"
          echo "â•‘  ğŸ“ˆ PHASE 5 & 6: MEASURE & LEARN                                 â•‘"
          echo "â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â•‘"
          echo "â•‘  Metrics recorded for week $(date -u +%Y-%W)                          â•‘"
          echo "â•‘  Learning patterns updated                                       â•‘"
          echo "â•‘                                                                  â•‘"
          echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
          echo "â•‘                                                                  â•‘"
          echo "â•‘  ğŸ”— Admin Dashboard: https://www.chrisdavidsalon.com/admin/      â•‘"
          echo "â•‘  ğŸ“… Next Run: Sunday 6:00 AM EST                                 â•‘"
          echo "â•‘                                                                  â•‘"
          echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
