<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEO Changes Log | Chris David Salon Admin</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@2.2.1/dist/chartjs-plugin-annotation.min.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background: #0f172a; }
        .glass-card {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.1);
        }
        .glow-green { box-shadow: 0 0 20px rgba(34, 197, 94, 0.3); }
        .glow-yellow { box-shadow: 0 0 20px rgba(234, 179, 8, 0.3); }
        .glow-purple { box-shadow: 0 0 20px rgba(168, 85, 247, 0.3); }
        .glow-blue { box-shadow: 0 0 20px rgba(59, 130, 246, 0.3); }
        .status-pending { background: rgba(234, 179, 8, 0.2); border-color: rgba(234, 179, 8, 0.5); }
        .status-live { background: rgba(34, 197, 94, 0.2); border-color: rgba(34, 197, 94, 0.5); }
        .status-learning { background: rgba(168, 85, 247, 0.2); border-color: rgba(168, 85, 247, 0.5); }
        .category-Strategy { background: #7c3aed; }
        .category-UX { background: #3b82f6; }
        .category-Technical { background: #6366f1; }
        .category-System { background: #8b5cf6; }
        .category-Content { background: #10b981; }
    </style>
    <script src="shared-nav.js"></script>
</head>
<body class="min-h-screen text-gray-100">
    <!-- Shared Navigation -->
    <div id="admin-nav" data-page="changes-log"></div>

    <div class="max-w-7xl mx-auto px-4 py-8">
        <!-- Header -->
        <div class="glass-card rounded-xl p-6 mb-8 glow-purple">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-2xl font-bold flex items-center">
                        <i class="fas fa-clipboard-list text-purple-400 mr-3"></i>
                        SEO Changes Log
                    </h1>
                    <p class="text-gray-400 mt-1">Track all SEO optimizations and measure their effectiveness</p>
                </div>
                <div class="text-right">
                    <div class="text-sm text-gray-400">Last Updated</div>
                    <div id="lastUpdated" class="text-lg font-semibold text-purple-400">--</div>
                </div>
            </div>
        </div>

        <!-- SEO Progress Graph -->
        <div class="glass-card rounded-xl p-6 mb-8 glow-blue">
            <h2 class="text-xl font-bold mb-4 flex items-center">
                <i class="fas fa-chart-area text-blue-400 mr-3"></i>
                SEO Score Progress Over Time
                <span class="ml-3 text-sm font-normal text-gray-400">Historical tracking since optimization began</span>
            </h2>
            <div class="relative" style="height: 300px;">
                <canvas id="seoProgressChart"></canvas>
            </div>
            <div class="flex flex-wrap gap-4 mt-4 text-sm text-gray-400">
                <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-green-500 mr-2"></span> Overall Score</div>
                <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-blue-500 mr-2"></span> Performance</div>
                <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-purple-500 mr-2"></span> Mobile</div>
                <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-yellow-500 mr-2"></span> UX</div>
                <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-red-400 mr-2"></span> Content</div>
                <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-cyan-500 mr-2"></span> Local</div>
            </div>
        </div>

        <!-- SEO Score Improvement Tracker -->
        <div class="glass-card rounded-xl p-6 mb-8 glow-green">
            <h2 class="text-xl font-bold mb-4 flex items-center">
                <i class="fas fa-chart-line text-green-400 mr-3"></i>
                SEO Score Improvement Tracker
                <span class="ml-3 text-sm font-normal text-gray-400">Target: All categories at 95+</span>
            </h2>
            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-4">
                <div class="text-center p-3 rounded-lg bg-slate-700/50">
                    <div class="text-xs text-gray-400 mb-1">Overall</div>
                    <div class="text-2xl font-bold text-white" id="score-overall">77</div>
                    <div class="text-xs text-green-400">↑ Started at 29</div>
                </div>
                <div class="text-center p-3 rounded-lg bg-slate-700/50">
                    <div class="text-xs text-gray-400 mb-1">Performance</div>
                    <div class="text-2xl font-bold text-red-400" id="score-performance">65</div>
                    <div class="text-xs text-green-400">↑ from 45</div>
                </div>
                <div class="text-center p-3 rounded-lg bg-slate-700/50">
                    <div class="text-xs text-gray-400 mb-1">Technical</div>
                    <div class="text-2xl font-bold text-green-400" id="score-technical">100</div>
                    <div class="text-xs text-green-400">✓ Target Met</div>
                </div>
                <div class="text-center p-3 rounded-lg bg-slate-700/50">
                    <div class="text-xs text-gray-400 mb-1">Mobile</div>
                    <div class="text-2xl font-bold text-green-400" id="score-mobile">96</div>
                    <div class="text-xs text-green-400">↑ from 75</div>
                </div>
                <div class="text-center p-3 rounded-lg bg-slate-700/50">
                    <div class="text-xs text-gray-400 mb-1">Content</div>
                    <div class="text-2xl font-bold text-red-400" id="score-content">65</div>
                    <div class="text-xs text-green-400">↑ from 50</div>
                </div>
                <div class="text-center p-3 rounded-lg bg-slate-700/50">
                    <div class="text-xs text-gray-400 mb-1">Local</div>
                    <div class="text-2xl font-bold text-yellow-400" id="score-local">91</div>
                    <div class="text-xs text-green-400">↑ from 85</div>
                </div>
                <div class="text-center p-3 rounded-lg bg-slate-700/50">
                    <div class="text-xs text-gray-400 mb-1">UX</div>
                    <div class="text-2xl font-bold text-yellow-400" id="score-ux">81</div>
                    <div class="text-xs text-green-400">↑ from 70</div>
                </div>
                <div class="text-center p-3 rounded-lg bg-slate-700/50">
                    <div class="text-xs text-gray-400 mb-1">Authority</div>
                    <div class="text-2xl font-bold text-red-400" id="score-authority">29</div>
                    <div class="text-xs text-gray-400">Building...</div>
                </div>
            </div>
            <div class="text-sm text-gray-400 border-t border-slate-600 pt-3">
                <strong class="text-white">Journey:</strong> Overall 29 → 72 → 77 (+48 points in 3 days) | Mobile 75 → 96 (+21) | Performance 45 → 65 (+20) | Technical → 100 ✓
            </div>
        </div>

        <!-- Summary Stats -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="glass-card rounded-xl p-6 glow-blue">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-gray-400 text-sm">Total Changes</span>
                    <i class="fas fa-list text-blue-400"></i>
                </div>
                <div class="text-3xl font-bold text-blue-400" id="totalChanges">--</div>
            </div>
            <div class="glass-card rounded-xl p-6 glow-yellow">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-gray-400 text-sm">Pending Measurement</span>
                    <i class="fas fa-clock text-yellow-400"></i>
                </div>
                <div class="text-3xl font-bold text-yellow-400" id="pendingMeasurement">--</div>
            </div>
            <div class="glass-card rounded-xl p-6 glow-green">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-gray-400 text-sm">Proven Effective</span>
                    <i class="fas fa-check-circle text-green-400"></i>
                </div>
                <div class="text-3xl font-bold text-green-400" id="provenEffective">--</div>
            </div>
            <div class="glass-card rounded-xl p-6 glow-purple">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-gray-400 text-sm">Active Learning</span>
                    <i class="fas fa-brain text-purple-400"></i>
                </div>
                <div class="text-3xl font-bold text-purple-400" id="activeLearning">--</div>
            </div>
        </div>

        <!-- Changes Timeline -->
        <div class="glass-card rounded-xl p-6 mb-8">
            <h2 class="text-xl font-bold mb-6 flex items-center">
                <i class="fas fa-timeline text-blue-400 mr-3"></i>
                Change History
            </h2>
            <div id="changesTimeline" class="space-y-6">
                <div class="text-center text-gray-500 py-8">
                    <i class="fas fa-spinner fa-spin text-4xl mb-4"></i>
                    <p>Loading changes log...</p>
                </div>
            </div>
        </div>

        <!-- Legend -->
        <div class="glass-card rounded-xl p-6">
            <h3 class="text-lg font-semibold mb-4">Status Legend</h3>
            <div class="flex flex-wrap gap-4">
                <div class="flex items-center">
                    <span class="w-3 h-3 bg-yellow-500 rounded-full mr-2"></span>
                    <span class="text-sm text-gray-400">Pending Measurement - Change made, waiting for data</span>
                </div>
                <div class="flex items-center">
                    <span class="w-3 h-3 bg-green-500 rounded-full mr-2"></span>
                    <span class="text-sm text-gray-400">Live Monitoring - Actively tracking effectiveness</span>
                </div>
                <div class="flex items-center">
                    <span class="w-3 h-3 bg-purple-500 rounded-full mr-2"></span>
                    <span class="text-sm text-gray-400">Active Learning - System learning from results</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        const BASE_URL = 'https://www.chrisdavidsalon.com';

        async function loadChangesLog() {
            try {
                const response = await fetch(`${BASE_URL}/data/seo-changes-log.json`);
                const data = await response.json();

                // Update summary stats
                document.getElementById('totalChanges').textContent = data.summary.totalChanges;
                document.getElementById('pendingMeasurement').textContent = data.summary.pendingMeasurement;
                document.getElementById('provenEffective').textContent =
                    data.log.filter(c => c.metrics.status === 'proven-effective').length || '0';
                document.getElementById('activeLearning').textContent =
                    data.log.filter(c => c.metrics.status === 'active-learning').length || '1';
                document.getElementById('lastUpdated').textContent =
                    new Date(data.summary.lastUpdated).toLocaleDateString('en-US', {
                        month: 'short', day: 'numeric', year: 'numeric', hour: '2-digit', minute: '2-digit'
                    });

                // Render timeline
                renderTimeline(data.log);
            } catch (error) {
                console.error('Error loading changes log:', error);
                document.getElementById('changesTimeline').innerHTML = `
                    <div class="text-center text-red-400 py-8">
                        <i class="fas fa-exclamation-triangle text-4xl mb-4"></i>
                        <p>Error loading changes log</p>
                        <p class="text-sm text-gray-500 mt-2">${error.message}</p>
                    </div>
                `;
            }
        }

        function renderTimeline(changes) {
            const container = document.getElementById('changesTimeline');

            if (!changes || changes.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <i class="fas fa-inbox text-4xl mb-4"></i>
                        <p>No changes logged yet</p>
                    </div>
                `;
                return;
            }

            const html = changes.map(change => {
                const statusClass = getStatusClass(change.metrics.status);
                const statusIcon = getStatusIcon(change.metrics.status);
                const statusLabel = getStatusLabel(change.metrics.status);

                return `
                    <div class="relative pl-8 pb-8 border-l-2 border-gray-700 last:border-l-0 last:pb-0">
                        <!-- Timeline dot -->
                        <div class="absolute left-0 top-0 transform -translate-x-1/2 w-4 h-4 rounded-full ${statusClass} border-2"></div>

                        <!-- Change card -->
                        <div class="glass-card rounded-lg p-5 ml-4">
                            <!-- Header -->
                            <div class="flex items-start justify-between mb-3">
                                <div>
                                    <div class="flex items-center gap-3 mb-1">
                                        <span class="px-2 py-1 rounded text-xs font-bold category-${change.category}">${change.category}</span>
                                        <span class="text-gray-400 text-sm">${change.version}</span>
                                        <span class="text-gray-500 text-sm">${formatDate(change.date)}</span>
                                    </div>
                                    <h3 class="text-lg font-semibold">${change.title}</h3>
                                </div>
                                <div class="flex items-center ${statusClass} px-3 py-1 rounded-full border">
                                    <i class="fas ${statusIcon} mr-2 text-sm"></i>
                                    <span class="text-sm font-medium">${statusLabel}</span>
                                </div>
                            </div>

                            <!-- Description -->
                            <p class="text-gray-400 mb-4">${change.description}</p>

                            <!-- Changes list -->
                            <div class="mb-4">
                                <div class="text-sm font-semibold text-gray-300 mb-2">Changes Made:</div>
                                <ul class="space-y-1">
                                    ${change.changes.map(c => `
                                        <li class="text-sm text-gray-400 flex items-start">
                                            <i class="fas fa-check text-green-500 mr-2 mt-1 text-xs"></i>
                                            ${c}
                                        </li>
                                    `).join('')}
                                </ul>
                            </div>

                            <!-- Expected Impact -->
                            <div class="mb-4">
                                <div class="text-sm font-semibold text-gray-300 mb-2">Expected Impact:</div>
                                <div class="flex flex-wrap gap-2">
                                    ${Object.entries(change.expectedImpact).map(([key, value]) => `
                                        <span class="bg-purple-900/50 px-3 py-1 rounded-full text-sm">
                                            <span class="text-gray-400">${formatKey(key)}:</span>
                                            <span class="text-purple-300 font-medium">${value}</span>
                                        </span>
                                    `).join('')}
                                </div>
                            </div>

                            <!-- Metrics comparison -->
                            ${renderMetrics(change.metrics)}
                        </div>
                    </div>
                `;
            }).join('');

            container.innerHTML = html;
        }

        function renderMetrics(metrics) {
            if (!metrics.before && !metrics.after) {
                return '<div class="text-sm text-gray-500 italic">No baseline metrics recorded</div>';
            }

            const beforeData = metrics.before ? Object.entries(metrics.before).filter(([k]) => k !== 'date') : [];
            const afterData = metrics.after ? Object.entries(metrics.after).filter(([k]) => k !== 'date') : [];

            return `
                <div class="grid grid-cols-2 gap-4 bg-gray-900/50 rounded-lg p-4">
                    <div>
                        <div class="text-sm font-semibold text-gray-300 mb-2">
                            <i class="fas fa-arrow-left text-red-400 mr-1"></i>
                            Before ${metrics.before?.date ? `(${metrics.before.date})` : ''}
                        </div>
                        ${beforeData.length ? beforeData.map(([k, v]) => `
                            <div class="text-sm text-gray-400">${formatKey(k)}: <span class="text-white">${v}</span></div>
                        `).join('') : '<div class="text-sm text-gray-500">No data</div>'}
                    </div>
                    <div>
                        <div class="text-sm font-semibold text-gray-300 mb-2">
                            <i class="fas fa-arrow-right text-green-400 mr-1"></i>
                            After ${metrics.after?.date ? `(${metrics.after.date})` : ''}
                        </div>
                        ${afterData.length ? afterData.map(([k, v]) => `
                            <div class="text-sm text-gray-400">${formatKey(k)}: <span class="text-white">${v}</span></div>
                        `).join('') : '<div class="text-sm text-yellow-400">Pending measurement...</div>'}
                    </div>
                </div>
            `;
        }

        function getStatusClass(status) {
            switch (status) {
                case 'pending-measurement': return 'status-pending';
                case 'live-monitoring': return 'status-live';
                case 'active-learning': return 'status-learning';
                case 'proven-effective': return 'status-live';
                default: return 'status-pending';
            }
        }

        function getStatusIcon(status) {
            switch (status) {
                case 'pending-measurement': return 'fa-clock';
                case 'live-monitoring': return 'fa-chart-line';
                case 'active-learning': return 'fa-brain';
                case 'proven-effective': return 'fa-check-circle';
                default: return 'fa-question-circle';
            }
        }

        function getStatusLabel(status) {
            switch (status) {
                case 'pending-measurement': return 'Pending';
                case 'live-monitoring': return 'Monitoring';
                case 'active-learning': return 'Learning';
                case 'proven-effective': return 'Effective';
                case 'pending-implementation': return 'Not Implemented';
                default: return status;
            }
        }

        function formatDate(dateStr) {
            return new Date(dateStr).toLocaleDateString('en-US', {
                month: 'short', day: 'numeric', year: 'numeric'
            });
        }

        function formatKey(key) {
            return key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase());
        }

        // SEO Progress Chart
        function initSeoProgressChart() {
            const ctx = document.getElementById('seoProgressChart').getContext('2d');

            // Historical data: Starting point (Dec 3) -> Yesterday (Dec 4) -> Today (Dec 5)
            const labels = ['Dec 3', 'Dec 4', 'Dec 5'];

            const data = {
                labels: labels,
                datasets: [
                    {
                        label: 'Overall',
                        data: [29, 72, 77],
                        borderColor: '#22c55e',
                        backgroundColor: 'rgba(34, 197, 94, 0.1)',
                        tension: 0.3,
                        fill: true,
                        borderWidth: 3,
                        pointRadius: 6,
                        pointBackgroundColor: '#22c55e'
                    },
                    {
                        label: 'Performance',
                        data: [45, 64, 65],
                        borderColor: '#3b82f6',
                        backgroundColor: 'transparent',
                        tension: 0.3,
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#3b82f6'
                    },
                    {
                        label: 'Mobile',
                        data: [75, 81, 96],
                        borderColor: '#a855f7',
                        backgroundColor: 'transparent',
                        tension: 0.3,
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#a855f7'
                    },
                    {
                        label: 'UX',
                        data: [70, 78, 81],
                        borderColor: '#eab308',
                        backgroundColor: 'transparent',
                        tension: 0.3,
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#eab308'
                    },
                    {
                        label: 'Content',
                        data: [50, 65, 65],
                        borderColor: '#f87171',
                        backgroundColor: 'transparent',
                        tension: 0.3,
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#f87171'
                    },
                    {
                        label: 'Local',
                        data: [85, 91, 91],
                        borderColor: '#06b6d4',
                        backgroundColor: 'transparent',
                        tension: 0.3,
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#06b6d4'
                    }
                ]
            };

            new Chart(ctx, {
                type: 'line',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(15, 23, 42, 0.9)',
                            titleColor: '#fff',
                            bodyColor: '#94a3b8',
                            borderColor: 'rgba(148, 163, 184, 0.2)',
                            borderWidth: 1,
                            padding: 12,
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y + '/100';
                                }
                            }
                        },
                        annotation: {
                            annotations: {
                                targetLine: {
                                    type: 'line',
                                    yMin: 95,
                                    yMax: 95,
                                    borderColor: 'rgba(34, 197, 94, 0.5)',
                                    borderWidth: 2,
                                    borderDash: [6, 6],
                                    label: {
                                        display: true,
                                        content: 'Target: 95',
                                        position: 'end',
                                        backgroundColor: 'rgba(34, 197, 94, 0.8)'
                                    }
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)'
                            },
                            ticks: {
                                color: '#94a3b8'
                            }
                        },
                        y: {
                            min: 0,
                            max: 100,
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)'
                            },
                            ticks: {
                                color: '#94a3b8',
                                callback: function(value) {
                                    return value;
                                }
                            }
                        }
                    }
                }
            });
        }

        // Load on page load
        document.addEventListener('DOMContentLoaded', () => {
            loadChangesLog();
            initSeoProgressChart();
        });
    </script>
</body>
</html>
