<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEO Changes Log | Chris David Salon Admin</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Inter', sans-serif; background: #0f172a; }
        .glass-card {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.1);
        }
        .glow-green { box-shadow: 0 0 20px rgba(34, 197, 94, 0.3); }
        .glow-yellow { box-shadow: 0 0 20px rgba(234, 179, 8, 0.3); }
        .glow-purple { box-shadow: 0 0 20px rgba(168, 85, 247, 0.3); }
        .glow-blue { box-shadow: 0 0 20px rgba(59, 130, 246, 0.3); }
        .status-pending { background: rgba(234, 179, 8, 0.2); border-color: rgba(234, 179, 8, 0.5); }
        .status-live { background: rgba(34, 197, 94, 0.2); border-color: rgba(34, 197, 94, 0.5); }
        .status-learning { background: rgba(168, 85, 247, 0.2); border-color: rgba(168, 85, 247, 0.5); }
        .category-Strategy { background: #7c3aed; }
        .category-UX { background: #3b82f6; }
        .category-Technical { background: #6366f1; }
        .category-System { background: #8b5cf6; }
        .category-Content { background: #10b981; }
    </style>
    <script src="shared-nav.js"></script>
</head>
<body class="min-h-screen text-gray-100">
    <!-- Shared Navigation -->
    <div id="admin-nav" data-page="changes-log"></div>

    <div class="max-w-7xl mx-auto px-4 py-8">
        <!-- Header -->
        <div class="glass-card rounded-xl p-6 mb-8 glow-purple">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-2xl font-bold flex items-center">
                        <i class="fas fa-clipboard-list text-purple-400 mr-3"></i>
                        SEO Changes Log
                    </h1>
                    <p class="text-gray-400 mt-1">Track all SEO optimizations and measure their effectiveness</p>
                </div>
                <div class="text-right">
                    <div class="text-sm text-gray-400">Last Updated</div>
                    <div id="lastUpdated" class="text-lg font-semibold text-purple-400">--</div>
                </div>
            </div>
        </div>

        <!-- Summary Stats -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="glass-card rounded-xl p-6 glow-blue">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-gray-400 text-sm">Total Changes</span>
                    <i class="fas fa-list text-blue-400"></i>
                </div>
                <div class="text-3xl font-bold text-blue-400" id="totalChanges">--</div>
            </div>
            <div class="glass-card rounded-xl p-6 glow-yellow">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-gray-400 text-sm">Pending Measurement</span>
                    <i class="fas fa-clock text-yellow-400"></i>
                </div>
                <div class="text-3xl font-bold text-yellow-400" id="pendingMeasurement">--</div>
            </div>
            <div class="glass-card rounded-xl p-6 glow-green">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-gray-400 text-sm">Proven Effective</span>
                    <i class="fas fa-check-circle text-green-400"></i>
                </div>
                <div class="text-3xl font-bold text-green-400" id="provenEffective">--</div>
            </div>
            <div class="glass-card rounded-xl p-6 glow-purple">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-gray-400 text-sm">Active Learning</span>
                    <i class="fas fa-brain text-purple-400"></i>
                </div>
                <div class="text-3xl font-bold text-purple-400" id="activeLearning">--</div>
            </div>
        </div>

        <!-- Changes Timeline -->
        <div class="glass-card rounded-xl p-6 mb-8">
            <h2 class="text-xl font-bold mb-6 flex items-center">
                <i class="fas fa-timeline text-blue-400 mr-3"></i>
                Change History
            </h2>
            <div id="changesTimeline" class="space-y-6">
                <div class="text-center text-gray-500 py-8">
                    <i class="fas fa-spinner fa-spin text-4xl mb-4"></i>
                    <p>Loading changes log...</p>
                </div>
            </div>
        </div>

        <!-- Legend -->
        <div class="glass-card rounded-xl p-6">
            <h3 class="text-lg font-semibold mb-4">Status Legend</h3>
            <div class="flex flex-wrap gap-4">
                <div class="flex items-center">
                    <span class="w-3 h-3 bg-yellow-500 rounded-full mr-2"></span>
                    <span class="text-sm text-gray-400">Pending Measurement - Change made, waiting for data</span>
                </div>
                <div class="flex items-center">
                    <span class="w-3 h-3 bg-green-500 rounded-full mr-2"></span>
                    <span class="text-sm text-gray-400">Live Monitoring - Actively tracking effectiveness</span>
                </div>
                <div class="flex items-center">
                    <span class="w-3 h-3 bg-purple-500 rounded-full mr-2"></span>
                    <span class="text-sm text-gray-400">Active Learning - System learning from results</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        const BASE_URL = 'https://www.chrisdavidsalon.com';

        async function loadChangesLog() {
            try {
                const response = await fetch(`${BASE_URL}/data/seo-changes-log.json`);
                const data = await response.json();

                // Update summary stats
                document.getElementById('totalChanges').textContent = data.summary.totalChanges;
                document.getElementById('pendingMeasurement').textContent = data.summary.pendingMeasurement;
                document.getElementById('provenEffective').textContent =
                    data.log.filter(c => c.metrics.status === 'proven-effective').length || '0';
                document.getElementById('activeLearning').textContent =
                    data.log.filter(c => c.metrics.status === 'active-learning').length || '1';
                document.getElementById('lastUpdated').textContent =
                    new Date(data.summary.lastUpdated).toLocaleDateString('en-US', {
                        month: 'short', day: 'numeric', year: 'numeric', hour: '2-digit', minute: '2-digit'
                    });

                // Render timeline
                renderTimeline(data.log);
            } catch (error) {
                console.error('Error loading changes log:', error);
                document.getElementById('changesTimeline').innerHTML = `
                    <div class="text-center text-red-400 py-8">
                        <i class="fas fa-exclamation-triangle text-4xl mb-4"></i>
                        <p>Error loading changes log</p>
                        <p class="text-sm text-gray-500 mt-2">${error.message}</p>
                    </div>
                `;
            }
        }

        function renderTimeline(changes) {
            const container = document.getElementById('changesTimeline');

            if (!changes || changes.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <i class="fas fa-inbox text-4xl mb-4"></i>
                        <p>No changes logged yet</p>
                    </div>
                `;
                return;
            }

            const html = changes.map(change => {
                const statusClass = getStatusClass(change.metrics.status);
                const statusIcon = getStatusIcon(change.metrics.status);
                const statusLabel = getStatusLabel(change.metrics.status);

                return `
                    <div class="relative pl-8 pb-8 border-l-2 border-gray-700 last:border-l-0 last:pb-0">
                        <!-- Timeline dot -->
                        <div class="absolute left-0 top-0 transform -translate-x-1/2 w-4 h-4 rounded-full ${statusClass} border-2"></div>

                        <!-- Change card -->
                        <div class="glass-card rounded-lg p-5 ml-4">
                            <!-- Header -->
                            <div class="flex items-start justify-between mb-3">
                                <div>
                                    <div class="flex items-center gap-3 mb-1">
                                        <span class="px-2 py-1 rounded text-xs font-bold category-${change.category}">${change.category}</span>
                                        <span class="text-gray-400 text-sm">${change.version}</span>
                                        <span class="text-gray-500 text-sm">${formatDate(change.date)}</span>
                                    </div>
                                    <h3 class="text-lg font-semibold">${change.title}</h3>
                                </div>
                                <div class="flex items-center ${statusClass} px-3 py-1 rounded-full border">
                                    <i class="fas ${statusIcon} mr-2 text-sm"></i>
                                    <span class="text-sm font-medium">${statusLabel}</span>
                                </div>
                            </div>

                            <!-- Description -->
                            <p class="text-gray-400 mb-4">${change.description}</p>

                            <!-- Changes list -->
                            <div class="mb-4">
                                <div class="text-sm font-semibold text-gray-300 mb-2">Changes Made:</div>
                                <ul class="space-y-1">
                                    ${change.changes.map(c => `
                                        <li class="text-sm text-gray-400 flex items-start">
                                            <i class="fas fa-check text-green-500 mr-2 mt-1 text-xs"></i>
                                            ${c}
                                        </li>
                                    `).join('')}
                                </ul>
                            </div>

                            <!-- Expected Impact -->
                            <div class="mb-4">
                                <div class="text-sm font-semibold text-gray-300 mb-2">Expected Impact:</div>
                                <div class="flex flex-wrap gap-2">
                                    ${Object.entries(change.expectedImpact).map(([key, value]) => `
                                        <span class="bg-purple-900/50 px-3 py-1 rounded-full text-sm">
                                            <span class="text-gray-400">${formatKey(key)}:</span>
                                            <span class="text-purple-300 font-medium">${value}</span>
                                        </span>
                                    `).join('')}
                                </div>
                            </div>

                            <!-- Metrics comparison -->
                            ${renderMetrics(change.metrics)}
                        </div>
                    </div>
                `;
            }).join('');

            container.innerHTML = html;
        }

        function renderMetrics(metrics) {
            if (!metrics.before && !metrics.after) {
                return '<div class="text-sm text-gray-500 italic">No baseline metrics recorded</div>';
            }

            const beforeData = metrics.before ? Object.entries(metrics.before).filter(([k]) => k !== 'date') : [];
            const afterData = metrics.after ? Object.entries(metrics.after).filter(([k]) => k !== 'date') : [];

            return `
                <div class="grid grid-cols-2 gap-4 bg-gray-900/50 rounded-lg p-4">
                    <div>
                        <div class="text-sm font-semibold text-gray-300 mb-2">
                            <i class="fas fa-arrow-left text-red-400 mr-1"></i>
                            Before ${metrics.before?.date ? `(${metrics.before.date})` : ''}
                        </div>
                        ${beforeData.length ? beforeData.map(([k, v]) => `
                            <div class="text-sm text-gray-400">${formatKey(k)}: <span class="text-white">${v}</span></div>
                        `).join('') : '<div class="text-sm text-gray-500">No data</div>'}
                    </div>
                    <div>
                        <div class="text-sm font-semibold text-gray-300 mb-2">
                            <i class="fas fa-arrow-right text-green-400 mr-1"></i>
                            After ${metrics.after?.date ? `(${metrics.after.date})` : ''}
                        </div>
                        ${afterData.length ? afterData.map(([k, v]) => `
                            <div class="text-sm text-gray-400">${formatKey(k)}: <span class="text-white">${v}</span></div>
                        `).join('') : '<div class="text-sm text-yellow-400">Pending measurement...</div>'}
                    </div>
                </div>
            `;
        }

        function getStatusClass(status) {
            switch (status) {
                case 'pending-measurement': return 'status-pending';
                case 'live-monitoring': return 'status-live';
                case 'active-learning': return 'status-learning';
                case 'proven-effective': return 'status-live';
                default: return 'status-pending';
            }
        }

        function getStatusIcon(status) {
            switch (status) {
                case 'pending-measurement': return 'fa-clock';
                case 'live-monitoring': return 'fa-chart-line';
                case 'active-learning': return 'fa-brain';
                case 'proven-effective': return 'fa-check-circle';
                default: return 'fa-question-circle';
            }
        }

        function getStatusLabel(status) {
            switch (status) {
                case 'pending-measurement': return 'Pending';
                case 'live-monitoring': return 'Monitoring';
                case 'active-learning': return 'Learning';
                case 'proven-effective': return 'Effective';
                case 'pending-implementation': return 'Not Implemented';
                default: return status;
            }
        }

        function formatDate(dateStr) {
            return new Date(dateStr).toLocaleDateString('en-US', {
                month: 'short', day: 'numeric', year: 'numeric'
            });
        }

        function formatKey(key) {
            return key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase());
        }

        // Load on page load
        document.addEventListener('DOMContentLoaded', loadChangesLog);
    </script>
</body>
</html>
