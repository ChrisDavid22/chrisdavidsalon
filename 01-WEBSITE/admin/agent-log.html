<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <title>Agent Implementations - Chris David Salon</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .pulse-green { animation: pulse-green 2s infinite; }
        @keyframes pulse-green {
            0%, 100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(34, 197, 94, 0); }
        }
        .type-feature { border-left: 4px solid #22c55e; }
        .type-bugfix { border-left: 4px solid #f59e0b; }
        .type-optimization { border-left: 4px solid #3b82f6; }
        .cat-api { background: #dbeafe; color: #1e40af; }
        .cat-dashboard { background: #f3e8ff; color: #7c3aed; }
        .cat-content { background: #dcfce7; color: #166534; }
        .cat-seo { background: #fef3c7; color: #92400e; }
        .cat-authority { background: #fee2e2; color: #991b1b; }
        .cat-reviews { background: #e0e7ff; color: #3730a3; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Top Navigation -->
    <nav class="bg-gradient-to-r from-indigo-900 to-purple-900 text-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-4">
                    <div class="flex items-center">
                        <div class="w-3 h-3 bg-green-400 rounded-full pulse-green mr-2"></div>
                        <span class="font-bold text-xl">Chris David SEO Agent</span>
                    </div>
                    <span id="versionBadge" class="bg-green-500 px-2 py-1 rounded text-xs font-bold">Loading...</span>
                </div>
                <div class="flex items-center space-x-4">
                    <span id="lastUpdate" class="text-sm text-indigo-200">Loading...</span>
                    <a href="../index.html" class="bg-yellow-500 hover:bg-yellow-600 px-3 py-1 rounded text-sm font-semibold">
                        View Site
                    </a>
                </div>
            </div>
            <!-- Navigation Tabs -->
            <div class="flex space-x-1 pb-2 overflow-x-auto">
                <a href="dashboard.html" class="px-4 py-2 hover:bg-white/10 rounded-t">Dashboard</a>
                <a href="traffic.html" class="px-4 py-2 hover:bg-white/10 rounded-t">Traffic</a>
                <a href="competitors.html" class="px-4 py-2 hover:bg-white/10 rounded-t">Competitors</a>
                <a href="rankings.html" class="px-4 py-2 hover:bg-white/10 rounded-t">Rankings</a>
                <a href="authority.html" class="px-4 py-2 hover:bg-white/10 rounded-t">Authority</a>
                <a href="microsites.html" class="px-4 py-2 hover:bg-white/10 rounded-t">Microsites</a>
                <a href="agent-log.html" class="px-4 py-2 bg-white/20 rounded-t font-semibold">Agent Log</a>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 py-6">
        <!-- Page Header -->
        <div class="mb-6">
            <h1 class="text-2xl font-bold text-gray-800">Agent Implementation Log</h1>
            <p class="text-gray-600">Real changes made to the site by the SEO Agent - with dates and proof</p>
        </div>

        <!-- Stats Summary -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-white rounded-xl shadow p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="text-sm text-gray-500">Total Implementations</div>
                        <div class="text-3xl font-bold" id="totalImplementations">--</div>
                    </div>
                    <div class="text-3xl text-green-500"><i class="fas fa-code-branch"></i></div>
                </div>
                <div class="mt-2 text-xs text-gray-500">shipped to production</div>
            </div>
            <div class="bg-white rounded-xl shadow p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="text-sm text-gray-500">Pending Actions</div>
                        <div class="text-3xl font-bold" id="pendingActions">--</div>
                    </div>
                    <div class="text-3xl text-yellow-500"><i class="fas fa-clock"></i></div>
                </div>
                <div class="mt-2 text-xs text-gray-500">in the queue</div>
            </div>
            <div class="bg-white rounded-xl shadow p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="text-sm text-gray-500">APIs Connected</div>
                        <div class="text-3xl font-bold" id="apisConnected">4</div>
                    </div>
                    <div class="text-3xl text-blue-500"><i class="fas fa-plug"></i></div>
                </div>
                <div class="mt-2 text-xs text-gray-500">GA4, Places, PageSpeed, Claude</div>
            </div>
            <div class="bg-white rounded-xl shadow p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="text-sm text-gray-500">Landing Pages</div>
                        <div class="text-3xl font-bold">5</div>
                    </div>
                    <div class="text-3xl text-purple-500"><i class="fas fa-file-alt"></i></div>
                </div>
                <div class="mt-2 text-xs text-gray-500">service pages created</div>
            </div>
        </div>

        <!-- Two Column Layout -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

            <!-- Left: Implementation History (2 cols) -->
            <div class="lg:col-span-2">
                <div class="bg-white rounded-xl shadow p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-bold">
                            <i class="fas fa-history text-green-500 mr-2"></i>
                            Implementation History
                        </h2>
                        <span class="text-sm text-gray-500">Sorted by date (newest first)</span>
                    </div>
                    <div id="implementationList" class="space-y-4">
                        <div class="text-center py-8 text-gray-500">
                            <i class="fas fa-spinner fa-spin text-2xl mb-2"></i>
                            <p>Loading implementations...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right: Pending Actions -->
            <div>
                <div class="bg-white rounded-xl shadow p-6 mb-6">
                    <h2 class="text-lg font-bold mb-4">
                        <i class="fas fa-tasks text-yellow-500 mr-2"></i>
                        Pending Actions
                    </h2>
                    <div id="pendingList" class="space-y-3">
                        <div class="text-center py-4 text-gray-500">Loading...</div>
                    </div>
                </div>

                <!-- Category Breakdown -->
                <div class="bg-white rounded-xl shadow p-6">
                    <h2 class="text-lg font-bold mb-4">
                        <i class="fas fa-chart-pie text-indigo-500 mr-2"></i>
                        By Category
                    </h2>
                    <div id="categoryBreakdown" class="space-y-2">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Data Source Notice -->
        <div class="mt-6 bg-green-50 border border-green-200 rounded-lg p-4">
            <div class="flex items-center">
                <i class="fas fa-database text-green-500 mr-3"></i>
                <div>
                    <span class="font-semibold text-green-800">Data Source: /data/agent-implementations.json</span>
                    <p class="text-green-700 text-sm">This log is updated with every deployment. Each entry represents actual code changes pushed to production.</p>
                </div>
            </div>
        </div>
    </main>

    <script>
        async function loadImplementations() {
            try {
                // Load REAL implementation data
                const response = await fetch('/data/agent-implementations.json');
                const data = await response.json();

                // Update stats
                document.getElementById('totalImplementations').textContent = data.implementations.length;
                document.getElementById('pendingActions').textContent = data.pendingActions.length;

                // Render implementation list
                renderImplementations(data.implementations);

                // Render pending actions
                renderPendingActions(data.pendingActions);

                // Render category breakdown
                renderCategoryBreakdown(data.metrics.byCategory);

                // Load version
                const versionResp = await fetch('/data/version.json');
                const versionData = await versionResp.json();
                document.getElementById('versionBadge').textContent = 'v' + versionData.version;

                document.getElementById('lastUpdate').textContent = 'Updated: ' + new Date().toLocaleTimeString();

            } catch (error) {
                console.error('Error loading implementations:', error);
                document.getElementById('implementationList').innerHTML = `
                    <div class="text-center py-8 text-red-500">
                        <i class="fas fa-exclamation-circle text-2xl mb-2"></i>
                        <p>Error loading data: ${error.message}</p>
                    </div>
                `;
            }
        }

        function renderImplementations(implementations) {
            const container = document.getElementById('implementationList');

            container.innerHTML = implementations.map(impl => {
                const date = new Date(impl.date);
                const typeClass = `type-${impl.type}`;
                const catClass = `cat-${impl.category}`;
                const typeIcon = impl.type === 'feature' ? 'fa-plus-circle' : impl.type === 'bugfix' ? 'fa-wrench' : 'fa-bolt';
                const typeColor = impl.type === 'feature' ? 'text-green-500' : impl.type === 'bugfix' ? 'text-yellow-500' : 'text-blue-500';

                return `
                    <div class="bg-gray-50 rounded-lg p-4 ${typeClass}">
                        <div class="flex items-start justify-between mb-2">
                            <div class="flex items-start">
                                <div class="text-xl mr-3 ${typeColor}">
                                    <i class="fas ${typeIcon}"></i>
                                </div>
                                <div>
                                    <h3 class="font-semibold">${impl.title}</h3>
                                    <p class="text-gray-600 text-sm mt-1">${impl.description}</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-sm font-mono bg-gray-200 px-2 py-1 rounded">${impl.version}</div>
                            </div>
                        </div>

                        <div class="flex items-center justify-between mt-3 pt-3 border-t border-gray-200">
                            <div class="flex items-center space-x-3">
                                <span class="text-xs px-2 py-1 rounded ${catClass}">${impl.category}</span>
                                <span class="text-xs text-gray-500">
                                    <i class="far fa-calendar mr-1"></i>${date.toLocaleDateString()}
                                </span>
                                <span class="text-xs text-gray-500">
                                    <i class="far fa-clock mr-1"></i>${date.toLocaleTimeString()}
                                </span>
                            </div>
                            ${impl.actualResult ? `
                                <span class="text-xs text-green-600 font-medium">
                                    <i class="fas fa-check mr-1"></i>${impl.actualResult}
                                </span>
                            ` : ''}
                        </div>

                        ${impl.files && impl.files.length > 0 ? `
                            <div class="mt-2 text-xs text-gray-500">
                                <i class="fas fa-file-code mr-1"></i>
                                ${impl.files.slice(0, 3).join(', ')}${impl.files.length > 3 ? ` +${impl.files.length - 3} more` : ''}
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        function renderPendingActions(actions) {
            const container = document.getElementById('pendingList');

            container.innerHTML = actions.map(action => {
                const priorityColor = action.priority === 'high' ? 'bg-red-100 text-red-700' :
                                     action.priority === 'medium' ? 'bg-yellow-100 text-yellow-700' :
                                     'bg-gray-100 text-gray-700';
                const catClass = `cat-${action.category}`;

                return `
                    <div class="border rounded-lg p-3 hover:border-indigo-300 transition-colors">
                        <div class="flex items-start justify-between mb-1">
                            <h4 class="font-medium text-sm">${action.title}</h4>
                            <span class="text-xs px-2 py-0.5 rounded ${priorityColor}">${action.priority}</span>
                        </div>
                        <p class="text-xs text-gray-600 mb-2">${action.description}</p>
                        <div class="flex items-center justify-between">
                            <span class="text-xs px-2 py-0.5 rounded ${catClass}">${action.category}</span>
                            <span class="text-xs text-green-600">${action.estimatedImpact}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderCategoryBreakdown(categories) {
            const container = document.getElementById('categoryBreakdown');
            const total = Object.values(categories).reduce((a, b) => a + b, 0);

            const categoryLabels = {
                dashboard: { label: 'Dashboard', icon: 'fa-tachometer-alt', color: 'bg-purple-500' },
                api: { label: 'API Integrations', icon: 'fa-plug', color: 'bg-blue-500' },
                content: { label: 'Content', icon: 'fa-file-alt', color: 'bg-green-500' },
                seo: { label: 'SEO', icon: 'fa-search', color: 'bg-yellow-500' },
                authority: { label: 'Authority', icon: 'fa-crown', color: 'bg-red-500' },
                reviews: { label: 'Reviews', icon: 'fa-star', color: 'bg-indigo-500' }
            };

            container.innerHTML = Object.entries(categories).map(([key, count]) => {
                const cat = categoryLabels[key] || { label: key, icon: 'fa-circle', color: 'bg-gray-500' };
                const pct = Math.round((count / total) * 100);

                return `
                    <div class="flex items-center justify-between text-sm">
                        <div class="flex items-center">
                            <i class="fas ${cat.icon} ${cat.color.replace('bg-', 'text-')} w-5"></i>
                            <span class="ml-2">${cat.label}</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-20 bg-gray-200 rounded-full h-2 mr-2">
                                <div class="${cat.color} h-2 rounded-full" style="width: ${pct}%"></div>
                            </div>
                            <span class="font-medium">${count}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Load on page load
        loadImplementations();

        // Auto-refresh every 5 minutes
        setInterval(loadImplementations, 300000);
    </script>
</body>
</html>
