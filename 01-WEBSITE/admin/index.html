<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEO Command Center - Chris David Salon</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="ai-config.js"></script>
</head>
<body class="bg-gray-100">
    <!-- Navigation -->
    <nav class="bg-gradient-to-r from-purple-900 to-indigo-900 text-white p-4 shadow-lg">
        <div class="max-w-7xl mx-auto">
            <div class="flex justify-between items-center mb-4">
                <div>
                    <h1 class="text-2xl font-bold">Chris David Salon - SEO Command Center</h1>
                    <p class="text-sm text-purple-200">AI-Powered SEO Analysis & Intelligence</p>
                </div>
                <div class="flex items-center gap-4">
                    <span id="versionBadge" class="bg-green-600 px-3 py-1 rounded text-sm font-bold">v2.6.12</span>
                    <a href="../index.html" class="bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded text-sm font-semibold">
                        ‚Üê Back to Main Site
                    </a>
                    <a href="login.html" onclick="localStorage.clear(); return true;" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded text-sm font-semibold">
                        Logout
                    </a>
                </div>
            </div>
            
            <!-- Navigation Menu -->
            <div class="flex flex-wrap gap-2 text-sm">
                <a href="index.html" class="bg-purple-600 px-3 py-1 rounded font-bold">üéØ SEO Command</a>
                <a href="competitors.html" class="bg-purple-800 hover:bg-purple-700 px-3 py-1 rounded">üèÜ Competitors</a>
                <a href="performance.html" class="bg-purple-800 hover:bg-purple-700 px-3 py-1 rounded">‚ö° Performance</a>
                <a href="rankings.html" class="bg-purple-800 hover:bg-purple-700 px-3 py-1 rounded">üìä Rankings</a>
                <a href="microsites.html" class="bg-purple-800 hover:bg-purple-700 px-3 py-1 rounded">üåê Microsites</a>
            </div>
        </div>
    </nav>

    <div class="max-w-7xl mx-auto p-6">
        
        <!-- Master Control Panel -->
        <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg shadow-xl p-6 mb-6">
            <h2 class="text-3xl font-bold mb-4">üéØ SEO Command Center</h2>
            <p class="text-blue-100 mb-6">
                Analyze your site with AI to get a comprehensive SEO score (0-100) with detailed breakdown and actionable improvements.
            </p>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <!-- Your Site Analysis -->
                <div class="bg-white/20 backdrop-blur-sm p-6 rounded-lg">
                    <h3 class="font-bold text-xl mb-4">Your Site Score</h3>
                    <div id="yourScore" class="text-6xl font-bold mb-4">--</div>
                    <button onclick="analyzeMySite()" class="bg-white text-blue-600 px-6 py-3 rounded-lg hover:bg-blue-50 w-full font-bold transition-all">
                        <i class="fas fa-brain mr-2"></i>Analyze with AI
                    </button>
                    <p class="text-xs mt-2 text-blue-100">Uses Claude AI + Google APIs</p>
                </div>
                
                <!-- Last Analysis -->
                <div class="bg-white/20 backdrop-blur-sm p-6 rounded-lg">
                    <h3 class="font-bold text-xl mb-4">Last Analysis</h3>
                    <div id="lastAnalysis" class="text-lg mb-4">Never</div>
                    <div id="scoreChange" class="text-3xl font-bold">--</div>
                    <p class="text-sm mt-2">Change from previous</p>
                </div>
                
                <!-- Quick Actions -->
                <div class="bg-white/20 backdrop-blur-sm p-6 rounded-lg">
                    <h3 class="font-bold text-xl mb-4">Quick Actions</h3>
                    <button onclick="runQuickAudit()" class="bg-yellow-500 text-white px-4 py-2 rounded w-full mb-2 hover:bg-yellow-600">
                        <i class="fas fa-bolt mr-2"></i>Quick Audit
                    </button>
                    <button onclick="compareToCompetitor()" class="bg-green-500 text-white px-4 py-2 rounded w-full hover:bg-green-600">
                        <i class="fas fa-chart-line mr-2"></i>Compare to #1
                    </button>
                </div>
            </div>
        </div>

        <!-- 7-Category SEO Breakdown -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h3 class="text-2xl font-bold mb-6">üìä SEO Score Breakdown (7 Categories)</h3>
            
            <div id="loadingIndicator" class="hidden text-center py-12">
                <i class="fas fa-spinner fa-spin text-5xl text-blue-600 mb-4"></i>
                <p class="text-xl text-gray-600">Analyzing your site with AI...</p>
                <p class="text-sm text-gray-500 mt-2">This comprehensive analysis takes 15-30 seconds</p>
            </div>
            
            <div id="scoreBreakdown" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                <!-- Performance -->
                <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-lg border-2 border-blue-200">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-bold text-lg text-blue-800">‚ö° Performance</h4>
                        <span id="performanceScore" class="text-3xl font-bold text-blue-600">--</span>
                    </div>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>Page Speed:</span>
                            <span id="pageSpeed" class="font-semibold">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Load Time:</span>
                            <span id="loadTime" class="font-semibold">--</span>
                        </div>
                        <div id="performanceIssues" class="mt-3 text-xs text-gray-600"></div>
                    </div>
                </div>

                <!-- Content Quality -->
                <div class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-lg border-2 border-green-200">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-bold text-lg text-green-800">üìù Content</h4>
                        <span id="contentScore" class="text-3xl font-bold text-green-600">--</span>
                    </div>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>Keywords:</span>
                            <span id="keywordUsage" class="font-semibold">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Quality:</span>
                            <span id="contentQuality" class="font-semibold">--</span>
                        </div>
                        <div id="contentIssues" class="mt-3 text-xs text-gray-600"></div>
                    </div>
                </div>

                <!-- Technical SEO -->
                <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-lg border-2 border-purple-200">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-bold text-lg text-purple-800">üîß Technical</h4>
                        <span id="technicalScore" class="text-3xl font-bold text-purple-600">--</span>
                    </div>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>Meta Tags:</span>
                            <span id="metaTags" class="font-semibold">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Schema:</span>
                            <span id="schema" class="font-semibold">--</span>
                        </div>
                        <div id="technicalIssues" class="mt-3 text-xs text-gray-600"></div>
                    </div>
                </div>

                <!-- Mobile Optimization -->
                <div class="bg-gradient-to-br from-orange-50 to-orange-100 p-6 rounded-lg border-2 border-orange-200">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-bold text-lg text-orange-800">üì± Mobile</h4>
                        <span id="mobileScore" class="text-3xl font-bold text-orange-600">--</span>
                    </div>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>Responsive:</span>
                            <span id="responsive" class="font-semibold">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Usability:</span>
                            <span id="mobileUsability" class="font-semibold">--</span>
                        </div>
                        <div id="mobileIssues" class="mt-3 text-xs text-gray-600"></div>
                    </div>
                </div>

                <!-- User Experience -->
                <div class="bg-gradient-to-br from-pink-50 to-pink-100 p-6 rounded-lg border-2 border-pink-200">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-bold text-lg text-pink-800">üé® UX</h4>
                        <span id="uxScore" class="text-3xl font-bold text-pink-600">--</span>
                    </div>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>Navigation:</span>
                            <span id="navigation" class="font-semibold">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Design:</span>
                            <span id="design" class="font-semibold">--</span>
                        </div>
                        <div id="uxIssues" class="mt-3 text-xs text-gray-600"></div>
                    </div>
                </div>

                <!-- Local SEO -->
                <div class="bg-gradient-to-br from-yellow-50 to-yellow-100 p-6 rounded-lg border-2 border-yellow-200">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-bold text-lg text-yellow-800">üìç Local</h4>
                        <span id="localScore" class="text-3xl font-bold text-yellow-600">--</span>
                    </div>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>GMB:</span>
                            <span id="gmb" class="font-semibold">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Citations:</span>
                            <span id="citations" class="font-semibold">--</span>
                        </div>
                        <div id="localIssues" class="mt-3 text-xs text-gray-600"></div>
                    </div>
                </div>

                <!-- Authority -->
                <div class="bg-gradient-to-br from-red-50 to-red-100 p-6 rounded-lg border-2 border-red-200">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-bold text-lg text-red-800">üèÜ Authority</h4>
                        <span id="authorityScore" class="text-3xl font-bold text-red-600">--</span>
                    </div>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>Backlinks:</span>
                            <span id="backlinks" class="font-semibold">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Trust:</span>
                            <span id="trust" class="font-semibold">--</span>
                        </div>
                        <div id="authorityIssues" class="mt-3 text-xs text-gray-600"></div>
                    </div>
                </div>

                <!-- Overall Summary -->
                <div class="bg-gradient-to-br from-gray-50 to-gray-100 p-6 rounded-lg border-2 border-gray-300">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-bold text-lg text-gray-800">üìà Summary</h4>
                        <span id="totalScore" class="text-3xl font-bold text-gray-700">--</span>
                    </div>
                    <canvas id="scoreChart" width="200" height="200"></canvas>
                </div>
            </div>
        </div>

        <!-- Action Items -->
        <div class="bg-gradient-to-r from-green-50 to-blue-50 rounded-lg shadow-lg p-6 mb-6">
            <h3 class="text-2xl font-bold mb-4">üéØ Priority Action Items</h3>
            <div id="actionItems" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-white p-4 rounded-lg shadow">
                    <p class="text-gray-500 text-center py-8">Run analysis to get personalized action items</p>
                </div>
            </div>
        </div>

        <!-- AI Prompts Section -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-2xl font-bold mb-4">ü§ñ AI Enhancement Prompts</h3>
            <p class="text-gray-600 mb-4">Copy these prompts to Claude or ChatGPT to get specific improvements for your site:</p>
            
            <div id="aiPrompts" class="space-y-4">
                <div class="bg-gray-50 p-4 rounded-lg">
                    <p class="text-sm text-gray-500">Prompts will appear here after analysis</p>
                </div>
            </div>
        </div>
    </div>

    <script>
    // Load AI Config
    window.AIConfig.loadApiKeys();

    // Load historical data
    let historicalScores = [];
    
    function loadHistory() {
        historicalScores = window.AIConfig.getHistory('seo', 30);
        if (historicalScores.length > 0) {
            const latest = historicalScores[0];
            document.getElementById('lastAnalysis').textContent = new Date(latest.timestamp).toLocaleDateString();
            document.getElementById('yourScore').textContent = Math.round(latest.data.totalScore);
            displayScoreBreakdown(latest.data);
        }
    }

    // Main analysis function
    async function analyzeMySite() {
        const url = 'https://www.chrisdavidsalon.com';

        // Show loading
        document.getElementById('loadingIndicator').classList.remove('hidden');
        document.getElementById('scoreBreakdown').style.opacity = '0.3';

        try {
            // Fetch SEO analysis AND AI recommendations in parallel
            const [seoResponse, aiResponse] = await Promise.all([
                fetch('/api/admin-data?type=seo-analysis'),
                fetch('/api/admin-data?type=ai-recommendations')
            ]);

            const seoResult = await seoResponse.json();
            const aiResult = await aiResponse.json();

            if (!seoResult.success) {
                throw new Error('SEO Analysis failed');
            }

            const fullAnalysis = seoResult.data;
            const timestamp = new Date();
            fullAnalysis.timestamp = timestamp.toISOString();
            fullAnalysis.live = seoResult.live;
            fullAnalysis.aiRecommendations = aiResult.data?.recommendations || [];
            fullAnalysis.aiLive = aiResult.live;

            // Save results to localStorage directly
            try {
                const history = JSON.parse(localStorage.getItem('seoHistory') || '[]');
                history.push({ type: 'seo', data: fullAnalysis, timestamp: fullAnalysis.timestamp });
                localStorage.setItem('seoHistory', JSON.stringify(history.slice(-30)));
            } catch (e) {
                console.warn('Could not save to history:', e);
            }

            // Display results
            displayScoreBreakdown(fullAnalysis);
            generateActionItems(fullAnalysis);
            generateAIPrompts(fullAnalysis);

            // Update history display
            loadHistory();

            // Update last analysis timestamp with detailed info
            const timeStr = timestamp.toLocaleString('en-US', {
                month: 'short', day: 'numeric', year: 'numeric',
                hour: 'numeric', minute: '2-digit', hour12: true
            });
            const liveStatus = seoResult.live ? 'üü¢ LIVE' : 'üü° Cached';
            const aiStatus = aiResult.live ? 'ü§ñ Claude AI' : 'üìã Fallback';
            document.getElementById('lastAnalysis').innerHTML = `
                <div class="text-lg font-bold">${timeStr}</div>
                <div class="text-sm mt-1">${liveStatus} Data ‚Ä¢ ${aiStatus}</div>
            `;

            // Show success notification
            const statusMsg = seoResult.live ? 'Live PageSpeed data retrieved!' : 'Using cached data (API rate limited)';
            const aiMsg = aiResult.live ? 'Claude AI recommendations generated!' : 'Using preset recommendations';
            console.log(`Analysis complete: ${statusMsg} ${aiMsg}`);

        } catch (error) {
            console.error('Analysis error:', error);
            document.getElementById('lastAnalysis').innerHTML = `
                <div class="text-lg font-bold text-red-400">${new Date().toLocaleString()}</div>
                <div class="text-sm mt-1">‚ö†Ô∏è Error - showing cached data</div>
            `;
        } finally {
            document.getElementById('loadingIndicator').classList.add('hidden');
            document.getElementById('scoreBreakdown').style.opacity = '1';
        }
    }

    // Display score breakdown
    function displayScoreBreakdown(data) {
        // Update total score
        const totalScore = Math.round(data.totalScore || 0);
        document.getElementById('yourScore').textContent = totalScore;
        document.getElementById('totalScore').textContent = totalScore + '/100';
        
        // Update category scores
        if (data.categories) {
            // Performance
            document.getElementById('performanceScore').textContent = Math.round(data.categories.performance?.score || 0);
            document.getElementById('pageSpeed').textContent = data.categories.performance?.score ? data.categories.performance.score + '%' : '--';
            document.getElementById('loadTime').textContent = data.pageSpeed?.lighthouseResult?.audits?.['speed-index']?.displayValue || '--';
            
            // Content
            document.getElementById('contentScore').textContent = Math.round(data.categories.content?.score || 0);
            document.getElementById('keywordUsage').textContent = data.categories.content?.score > 70 ? 'Good' : 'Needs Work';
            document.getElementById('contentQuality').textContent = data.categories.content?.score > 70 ? 'High' : 'Medium';
            
            // Technical
            document.getElementById('technicalScore').textContent = Math.round(data.categories.technical?.score || 0);
            document.getElementById('metaTags').textContent = data.categories.technical?.score > 70 ? 'Optimized' : 'Needs Work';
            document.getElementById('schema').textContent = data.categories.technical?.score > 70 ? 'Present' : 'Missing';
            
            // Mobile
            document.getElementById('mobileScore').textContent = Math.round(data.categories.mobile?.score || 0);
            document.getElementById('responsive').textContent = data.categories.mobile?.score > 70 ? 'Yes' : 'Partial';
            document.getElementById('mobileUsability').textContent = data.categories.mobile?.score > 70 ? 'Good' : 'Issues';
            
            // UX
            document.getElementById('uxScore').textContent = Math.round(data.categories.userExperience?.score || 0);
            document.getElementById('navigation').textContent = data.categories.userExperience?.score > 70 ? 'Clear' : 'Confusing';
            document.getElementById('design').textContent = data.categories.userExperience?.score > 70 ? 'Modern' : 'Dated';
            
            // Local
            document.getElementById('localScore').textContent = Math.round(data.categories.localSEO?.score || 0);
            document.getElementById('gmb').textContent = 'Active';
            document.getElementById('citations').textContent = '15+';
            
            // Authority
            document.getElementById('authorityScore').textContent = Math.round(data.categories.authority?.score || 0);
            document.getElementById('backlinks').textContent = '15 microsites';
            document.getElementById('trust').textContent = data.categories.authority?.score > 50 ? 'Growing' : 'Low';
        }
        
        // Draw chart
        drawScoreChart(data.categories);
    }

    // Generate action items
    function generateActionItems(data) {
        const container = document.getElementById('actionItems');
        container.innerHTML = '';
        
        const priorities = [];
        
        // Check each category for issues
        Object.entries(data.categories || {}).forEach(([category, info]) => {
            if (info.score < 70 && info.issues) {
                info.issues.forEach(issue => {
                    priorities.push({
                        category: category,
                        issue: issue,
                        score: info.score,
                        priority: info.score < 50 ? 'high' : 'medium'
                    });
                });
            }
        });
        
        // Sort by priority
        priorities.sort((a, b) => a.score - b.score);
        
        // Display top 6
        priorities.slice(0, 6).forEach(item => {
            const div = document.createElement('div');
            div.className = 'bg-white p-4 rounded-lg shadow border-l-4 ' + 
                           (item.priority === 'high' ? 'border-red-500' : 'border-yellow-500');
            div.innerHTML = `
                <div class="flex items-start">
                    <i class="fas fa-exclamation-triangle text-${item.priority === 'high' ? 'red' : 'yellow'}-500 mr-3 mt-1"></i>
                    <div>
                        <h4 class="font-semibold capitalize">${item.category.replace(/([A-Z])/g, ' $1').trim()}</h4>
                        <p class="text-sm text-gray-600 mt-1">${item.issue}</p>
                        <p class="text-xs text-gray-500 mt-2">Current score: ${Math.round(item.score)}/100</p>
                    </div>
                </div>
            `;
            container.appendChild(div);
        });
    }

    // Generate AI prompts
    function generateAIPrompts(data) {
        const container = document.getElementById('aiPrompts');
        container.innerHTML = '';
        
        const prompts = [
            {
                title: 'Performance Optimization',
                prompt: `I have a salon website at chrisdavidsalon.com with a current PageSpeed score of ${Math.round(data.categories?.performance?.score || 0)}. Please provide specific code changes to improve load time, optimize images, and enhance Core Web Vitals.`
            },
            {
                title: 'Content Enhancement',
                prompt: `My salon website needs better SEO content. We're a luxury salon in Delray Beach specializing in color and cuts. Current content score is ${Math.round(data.categories?.content?.score || 0)}. Please write optimized title tags, meta descriptions, and suggest content improvements for better local SEO.`
            },
            {
                title: 'Technical SEO Fixes',
                prompt: `Review the technical SEO for chrisdavidsalon.com. Current score is ${Math.round(data.categories?.technical?.score || 0)}. Provide schema markup for a hair salon, optimize robots.txt, and suggest technical improvements.`
            }
        ];
        
        prompts.forEach(item => {
            const div = document.createElement('div');
            div.className = 'bg-gray-50 p-4 rounded-lg';
            div.innerHTML = `
                <h4 class="font-semibold mb-2">${item.title}</h4>
                <div class="bg-white p-3 rounded border border-gray-200">
                    <p class="text-sm font-mono">${item.prompt}</p>
                </div>
                <button onclick="copyPrompt(this, '${item.prompt.replace(/'/g, "\\'")}')" 
                        class="mt-2 text-sm bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700">
                    <i class="fas fa-copy mr-1"></i>Copy Prompt
                </button>
            `;
            container.appendChild(div);
        });
    }

    // Copy prompt to clipboard
    function copyPrompt(button, prompt) {
        navigator.clipboard.writeText(prompt);
        button.innerHTML = '<i class="fas fa-check mr-1"></i>Copied!';
        setTimeout(() => {
            button.innerHTML = '<i class="fas fa-copy mr-1"></i>Copy Prompt';
        }, 2000);
    }

    // Quick audit (simplified version)
    async function runQuickAudit() {
        alert('Running quick PageSpeed test...');
        const data = await window.AIConfig.getPageSpeed('https://www.chrisdavidsalon.com');
        const score = Math.round(data.lighthouseResult.categories.performance.score * 100);
        alert(`Quick Performance Score: ${score}/100`);
    }

    // Compare to competitor
    function compareToCompetitor() {
        window.location.href = 'competitors.html';
    }

    // Draw score chart
    function drawScoreChart(categories) {
        const canvas = document.getElementById('scoreChart');
        if (!canvas) return;
        
        const ctx = canvas.getContext('2d');
        
        new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['Performance', 'Content', 'Technical', 'Mobile', 'UX', 'Local', 'Authority'],
                datasets: [{
                    label: 'Your Score',
                    data: [
                        categories?.performance?.score || 0,
                        categories?.content?.score || 0,
                        categories?.technical?.score || 0,
                        categories?.mobile?.score || 0,
                        categories?.userExperience?.score || 0,
                        categories?.localSEO?.score || 0,
                        categories?.authority?.score || 0
                    ],
                    backgroundColor: 'rgba(59, 130, 246, 0.2)',
                    borderColor: 'rgba(59, 130, 246, 1)',
                    borderWidth: 2
                }]
            },
            options: {
                scales: {
                    r: {
                        beginAtZero: true,
                        max: 100
                    }
                }
            }
        });
    }

    // Load dashboard data dynamically from API
    async function loadDashboardData() {
        try {
            // Fetch dashboard data from API
            const response = await fetch('/api/admin-data?type=dashboard');
            if (!response.ok) throw new Error('Dashboard API failed');
            const result = await response.json();
            const data = result.data;

            // Update score display
            const yourScoreEl = document.getElementById('yourScore');
            const totalScoreEl = document.getElementById('totalScore');
            if (yourScoreEl) yourScoreEl.textContent = data.seoScore || 73;
            if (totalScoreEl) totalScoreEl.textContent = (data.seoScore || 73) + '/100';

            // Display action items
            const actionContainer = document.getElementById('actionItems');
            if (actionContainer && data.actionItems) {
                actionContainer.innerHTML = '';
                data.actionItems.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'bg-white p-4 rounded-lg shadow border-l-4 ' +
                                   (item.priority === 'high' ? 'border-red-500' : 'border-yellow-500');
                    div.innerHTML = `
                        <div class="flex items-start">
                            <i class="fas fa-exclamation-triangle text-${item.priority === 'high' ? 'red' : 'yellow'}-500 mr-3 mt-1"></i>
                            <div>
                                <h4 class="font-semibold">${item.task}</h4>
                                <p class="text-sm text-gray-600 mt-1">Impact: ${item.impact}</p>
                            </div>
                        </div>
                    `;
                    actionContainer.appendChild(div);
                });
            }

            // Fetch SEO analysis data
            const seoResponse = await fetch('/api/admin-data?type=seo-analysis');
            if (seoResponse.ok) {
                const seoResult = await seoResponse.json();
                if (seoResult.data) displayScoreBreakdown(seoResult.data);
            }

        } catch (error) {
            console.error('Failed to load dashboard:', error);
            const yourScoreEl = document.getElementById('yourScore');
            if (yourScoreEl) yourScoreEl.textContent = '73';
        }
    }
    
    // Load and display version from version.json
    async function loadVersion() {
        try {
            const response = await fetch('/data/version.json');
            const data = await response.json();
            const versionBadge = document.getElementById('versionBadge');
            if (versionBadge && data.version) {
                versionBadge.textContent = `v${data.version}`;
                versionBadge.title = `Last updated: ${new Date(data.lastUpdated).toLocaleString()}`;
            }
        } catch (e) {
            console.warn('Could not load version:', e);
            const versionBadge = document.getElementById('versionBadge');
            if (versionBadge) versionBadge.textContent = 'v?.?.?';
        }
    }

    // Initialize on load
    window.addEventListener('load', () => {
        loadVersion();
        loadHistory();
        loadDashboardData();
    });
    </script>
</body>
</html>