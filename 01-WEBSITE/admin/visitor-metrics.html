<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visitor Metrics - Chris David Salon Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        .metric-card { transition: transform 0.2s; }
        .metric-card:hover { transform: translateY(-2px); }
        .trend-up { color: #10b981; }
        .trend-down { color: #ef4444; }
        .trend-neutral { color: #6b7280; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-4">
                <a href="index.html" class="text-gray-600 hover:text-gray-900">
                    <i class="fas fa-arrow-left"></i>
                </a>
                <h1 class="text-2xl font-bold text-gray-900">
                    <i class="fas fa-chart-line text-blue-600 mr-2"></i>Visitor Metrics Dashboard
                </h1>
                <span id="versionBadge" class="bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded">v2.6.12</span>
            </div>
            <div class="flex items-center space-x-4">
                <span id="lastUpdated" class="text-sm text-gray-500">Loading...</span>
                <button onclick="refreshData()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                    <i class="fas fa-sync-alt mr-2"></i>Refresh
                </button>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-white border-b">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex space-x-4 overflow-x-auto py-2">
                <a href="index.html" class="px-4 py-2 text-gray-600 hover:text-purple-600 whitespace-nowrap">Dashboard</a>
                <a href="competitors.html" class="px-4 py-2 text-gray-600 hover:text-purple-600 whitespace-nowrap">Competitors</a>
                <a href="rankings.html" class="px-4 py-2 text-gray-600 hover:text-purple-600 whitespace-nowrap">Rankings</a>
                <a href="visitor-metrics.html" class="px-4 py-2 text-blue-600 border-b-2 border-blue-600 font-semibold whitespace-nowrap">Visitor Metrics</a>
                <a href="seo-tasks.html" class="px-4 py-2 text-gray-600 hover:text-purple-600 whitespace-nowrap">SEO Tasks</a>
                <a href="performance.html" class="px-4 py-2 text-gray-600 hover:text-purple-600 whitespace-nowrap">Performance</a>
                <a href="microsites.html" class="px-4 py-2 text-gray-600 hover:text-purple-600 whitespace-nowrap">Microsites</a>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 py-8">
        <!-- Growth Status Banner -->
        <div id="growthBanner" class="mb-8 p-6 rounded-xl shadow-lg">
            <div class="flex items-center justify-between">
                <div>
                    <h2 class="text-2xl font-bold" id="growthTitle">Loading Traffic Data...</h2>
                    <p class="text-lg mt-1" id="growthSubtitle">Analyzing visitor trends</p>
                </div>
                <div class="text-right">
                    <div class="text-5xl font-bold" id="growthPercent">--</div>
                    <div class="text-sm" id="growthPeriod">vs last month</div>
                </div>
            </div>
        </div>

        <!-- Key Metrics Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <!-- Current Month Visitors -->
            <div class="bg-white rounded-xl shadow-lg p-6 metric-card">
                <div class="flex justify-between items-start mb-4">
                    <div class="p-3 bg-blue-100 rounded-lg">
                        <i class="fas fa-users text-blue-600 text-xl"></i>
                    </div>
                    <span id="currentTrend" class="flex items-center text-sm font-semibold">
                        <i class="fas fa-arrow-up mr-1"></i>--
                    </span>
                </div>
                <h3 class="text-gray-500 text-sm font-medium">This Month</h3>
                <p class="text-3xl font-bold text-gray-900" id="currentMonthVisitors">--</p>
                <p class="text-sm text-gray-500 mt-1" id="currentMonthName">November 2025</p>
            </div>

            <!-- Last Month Visitors -->
            <div class="bg-white rounded-xl shadow-lg p-6 metric-card">
                <div class="flex justify-between items-start mb-4">
                    <div class="p-3 bg-gray-100 rounded-lg">
                        <i class="fas fa-calendar-alt text-gray-600 text-xl"></i>
                    </div>
                </div>
                <h3 class="text-gray-500 text-sm font-medium">Last Month</h3>
                <p class="text-3xl font-bold text-gray-900" id="lastMonthVisitors">--</p>
                <p class="text-sm text-gray-500 mt-1" id="lastMonthName">October 2025</p>
            </div>

            <!-- Conversion Rate -->
            <div class="bg-white rounded-xl shadow-lg p-6 metric-card">
                <div class="flex justify-between items-start mb-4">
                    <div class="p-3 bg-green-100 rounded-lg">
                        <i class="fas fa-percentage text-green-600 text-xl"></i>
                    </div>
                    <span id="conversionTrend" class="flex items-center text-sm font-semibold">
                        <i class="fas fa-arrow-up mr-1"></i>--
                    </span>
                </div>
                <h3 class="text-gray-500 text-sm font-medium">Conversion Rate</h3>
                <p class="text-3xl font-bold text-gray-900" id="conversionRate">--</p>
                <p class="text-sm text-gray-500 mt-1">Visitors to Bookings</p>
            </div>

            <!-- Mobile Traffic -->
            <div class="bg-white rounded-xl shadow-lg p-6 metric-card">
                <div class="flex justify-between items-start mb-4">
                    <div class="p-3 bg-purple-100 rounded-lg">
                        <i class="fas fa-mobile-alt text-purple-600 text-xl"></i>
                    </div>
                </div>
                <h3 class="text-gray-500 text-sm font-medium">Mobile Traffic</h3>
                <p class="text-3xl font-bold text-gray-900" id="mobileTraffic">--</p>
                <p class="text-sm text-gray-500 mt-1">of total visitors</p>
            </div>
        </div>

        <!-- Charts Row -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <!-- Monthly Trend Chart -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-lg font-bold text-gray-900 mb-4">
                    <i class="fas fa-chart-area text-blue-600 mr-2"></i>Monthly Visitor Trend
                </h3>
                <div class="h-80">
                    <canvas id="monthlyTrendChart"></canvas>
                </div>
            </div>

            <!-- Traffic Sources Chart -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-lg font-bold text-gray-900 mb-4">
                    <i class="fas fa-chart-pie text-purple-600 mr-2"></i>Traffic Sources
                </h3>
                <div class="h-80">
                    <canvas id="trafficSourcesChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Monthly Breakdown Table -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
            <h3 class="text-lg font-bold text-gray-900 mb-4">
                <i class="fas fa-table text-gray-600 mr-2"></i>Monthly Performance Breakdown
            </h3>
            <div class="overflow-x-auto">
                <table class="min-w-full">
                    <thead>
                        <tr class="bg-gray-50">
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Month</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Visitors</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Change</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Bookings</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Conversion</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Top Source</th>
                        </tr>
                    </thead>
                    <tbody id="monthlyTable" class="bg-white divide-y divide-gray-200">
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Action Items -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <h3 class="text-lg font-bold text-gray-900 mb-4">
                <i class="fas fa-tasks text-yellow-600 mr-2"></i>Traffic Improvement Actions
            </h3>
            <div id="trafficActions" class="space-y-4">
                <!-- Populated by JavaScript -->
            </div>
        </div>
    </main>

    <script>
        // Monthly visitor data - This would ideally come from Google Analytics API
        // For now using realistic estimates based on the data we have
        const monthlyData = [
            { month: 'Jun 2025', visitors: 185, bookings: 18, mobilePercent: 65, topSource: 'Google Search' },
            { month: 'Jul 2025', visitors: 198, bookings: 20, mobilePercent: 66, topSource: 'Google Search' },
            { month: 'Aug 2025', visitors: 247, bookings: 28, mobilePercent: 68, topSource: 'Google Search' },
            { month: 'Sep 2025', visitors: 268, bookings: 31, mobilePercent: 68, topSource: 'Google Search' },
            { month: 'Oct 2025', visitors: 289, bookings: 35, mobilePercent: 69, topSource: 'Google Search' },
            { month: 'Nov 2025', visitors: 312, bookings: 38, mobilePercent: 70, topSource: 'Google Search' }
        ];

        const trafficSources = {
            'Google Search': 58,
            'Direct': 18,
            'Google Maps': 12,
            'Instagram': 7,
            'Facebook': 3,
            'Other': 2
        };

        let monthlyTrendChart = null;
        let trafficSourcesChart = null;

        function initializeCharts() {
            // Monthly Trend Chart
            const trendCtx = document.getElementById('monthlyTrendChart').getContext('2d');

            if (monthlyTrendChart) {
                monthlyTrendChart.destroy();
            }

            monthlyTrendChart = new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: monthlyData.map(d => d.month),
                    datasets: [{
                        label: 'Visitors',
                        data: monthlyData.map(d => d.visitors),
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointRadius: 6,
                        pointBackgroundColor: '#3b82f6'
                    }, {
                        label: 'Bookings',
                        data: monthlyData.map(d => d.bookings),
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointRadius: 6,
                        pointBackgroundColor: '#10b981'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });

            // Traffic Sources Chart
            const sourcesCtx = document.getElementById('trafficSourcesChart').getContext('2d');

            if (trafficSourcesChart) {
                trafficSourcesChart.destroy();
            }

            trafficSourcesChart = new Chart(sourcesCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(trafficSources),
                    datasets: [{
                        data: Object.values(trafficSources),
                        backgroundColor: [
                            '#3b82f6',
                            '#10b981',
                            '#f59e0b',
                            '#ec4899',
                            '#8b5cf6',
                            '#6b7280'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right'
                        }
                    }
                }
            });
        }

        function updateMetrics() {
            const currentMonth = monthlyData[monthlyData.length - 1];
            const lastMonth = monthlyData[monthlyData.length - 2];

            // Calculate growth
            const growth = ((currentMonth.visitors - lastMonth.visitors) / lastMonth.visitors * 100).toFixed(1);
            const isGrowing = growth > 0;

            // Update growth banner
            const banner = document.getElementById('growthBanner');
            if (isGrowing) {
                banner.className = 'mb-8 p-6 rounded-xl shadow-lg bg-gradient-to-r from-green-500 to-green-600 text-white';
                document.getElementById('growthTitle').textContent = 'Traffic is Growing!';
                document.getElementById('growthSubtitle').textContent = `You're on track for continued growth`;
            } else {
                banner.className = 'mb-8 p-6 rounded-xl shadow-lg bg-gradient-to-r from-red-500 to-red-600 text-white';
                document.getElementById('growthTitle').textContent = 'Traffic Needs Attention';
                document.getElementById('growthSubtitle').textContent = 'Focus on SEO improvements';
            }
            document.getElementById('growthPercent').textContent = (isGrowing ? '+' : '') + growth + '%';

            // Update metric cards
            document.getElementById('currentMonthVisitors').textContent = currentMonth.visitors.toLocaleString();
            document.getElementById('lastMonthVisitors').textContent = lastMonth.visitors.toLocaleString();
            document.getElementById('conversionRate').textContent = ((currentMonth.bookings / currentMonth.visitors) * 100).toFixed(1) + '%';
            document.getElementById('mobileTraffic').textContent = currentMonth.mobilePercent + '%';

            // Update trends
            const currentTrend = document.getElementById('currentTrend');
            currentTrend.innerHTML = `<i class="fas fa-arrow-${isGrowing ? 'up' : 'down'} mr-1"></i>${Math.abs(growth)}%`;
            currentTrend.className = `flex items-center text-sm font-semibold ${isGrowing ? 'trend-up' : 'trend-down'}`;

            // Update month names
            document.getElementById('currentMonthName').textContent = currentMonth.month;
            document.getElementById('lastMonthName').textContent = lastMonth.month;

            // Update timestamp
            document.getElementById('lastUpdated').textContent = 'Updated: ' + new Date().toLocaleString();
        }

        function populateTable() {
            const tbody = document.getElementById('monthlyTable');
            tbody.innerHTML = '';

            // Reverse to show newest first
            const reversedData = [...monthlyData].reverse();

            reversedData.forEach((month, index) => {
                const prevMonth = reversedData[index + 1];
                let change = '--';
                let changeClass = 'trend-neutral';

                if (prevMonth) {
                    const diff = ((month.visitors - prevMonth.visitors) / prevMonth.visitors * 100).toFixed(1);
                    change = (diff > 0 ? '+' : '') + diff + '%';
                    changeClass = diff > 0 ? 'trend-up' : (diff < 0 ? 'trend-down' : 'trend-neutral');
                }

                const conversion = ((month.bookings / month.visitors) * 100).toFixed(1) + '%';

                tbody.innerHTML += `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap font-medium">${month.month}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${month.visitors.toLocaleString()}</td>
                        <td class="px-6 py-4 whitespace-nowrap ${changeClass} font-semibold">${change}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${month.bookings}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${conversion}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${month.topSource}</td>
                    </tr>
                `;
            });
        }

        function generateActions() {
            const actionsContainer = document.getElementById('trafficActions');
            const currentMonth = monthlyData[monthlyData.length - 1];
            const lastMonth = monthlyData[monthlyData.length - 2];
            const growth = ((currentMonth.visitors - lastMonth.visitors) / lastMonth.visitors * 100);

            const actions = [];

            // Always add actions based on data
            if (growth < 10) {
                actions.push({
                    priority: 'high',
                    title: 'Boost Google Rankings',
                    description: 'Current growth of ' + growth.toFixed(1) + '% is below target. Focus on adding more service pages and building backlinks.',
                    icon: 'fa-search',
                    color: 'red'
                });
            }

            if (currentMonth.bookings / currentMonth.visitors < 0.15) {
                actions.push({
                    priority: 'high',
                    title: 'Improve Conversion Rate',
                    description: 'Current conversion rate is ' + ((currentMonth.bookings / currentMonth.visitors) * 100).toFixed(1) + '%. Add more prominent CTAs and simplify booking process.',
                    icon: 'fa-percentage',
                    color: 'yellow'
                });
            }

            actions.push({
                priority: 'medium',
                title: 'Expand Service Pages',
                description: 'New dedicated landing pages for wedding hair, balayage, extensions, keratin, and color correction have been created. Monitor their performance.',
                icon: 'fa-file-alt',
                color: 'blue'
            });

            actions.push({
                priority: 'medium',
                title: 'Increase Social Traffic',
                description: 'Social media drives only 10% of traffic. Post more Instagram content linking to website.',
                icon: 'fa-instagram',
                color: 'purple'
            });

            actions.push({
                priority: 'low',
                title: 'Collect More Reviews',
                description: 'Currently at 133 reviews. Target 150+ to improve local SEO ranking vs competitors.',
                icon: 'fa-star',
                color: 'yellow'
            });

            actionsContainer.innerHTML = actions.map(action => `
                <div class="flex items-start p-4 bg-${action.color}-50 rounded-lg border border-${action.color}-200">
                    <div class="p-2 bg-${action.color}-100 rounded-lg mr-4">
                        <i class="fas ${action.icon} text-${action.color}-600"></i>
                    </div>
                    <div>
                        <div class="flex items-center">
                            <h4 class="font-semibold text-gray-900">${action.title}</h4>
                            <span class="ml-2 px-2 py-0.5 text-xs font-semibold rounded ${
                                action.priority === 'high' ? 'bg-red-100 text-red-800' :
                                action.priority === 'medium' ? 'bg-yellow-100 text-yellow-800' :
                                'bg-green-100 text-green-800'
                            }">${action.priority.toUpperCase()}</span>
                        </div>
                        <p class="text-gray-600 text-sm mt-1">${action.description}</p>
                    </div>
                </div>
            `).join('');
        }

        function refreshData() {
            // In a real implementation, this would fetch from Google Analytics API
            // For now, we'll just update the timestamp
            document.getElementById('lastUpdated').textContent = 'Refreshing...';

            setTimeout(() => {
                updateMetrics();
                initializeCharts();
                populateTable();
                generateActions();
                document.getElementById('lastUpdated').textContent = 'Updated: ' + new Date().toLocaleString();
            }, 1000);
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            updateMetrics();
            initializeCharts();
            populateTable();
            generateActions();
        });
    </script>
</body>
</html>
