<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Chris David Salon</title>
    <meta name="robots" content="noindex, nofollow">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gray-100">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <h1 class="text-xl font-bold text-gray-800">Chris David Salon Admin</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="text-sm text-gray-600">Welcome, Admin</span>
                    <button onclick="logout()" class="text-red-600 hover:text-red-700">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
        <!-- Stats Overview -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="bg-white p-6 rounded-lg shadow">
                <div class="flex items-center">
                    <div class="p-3 bg-blue-100 rounded-full">
                        <i class="fas fa-users text-blue-600"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm text-gray-600">Total Visitors</p>
                        <p class="text-2xl font-bold text-gray-800" id="totalVisitors">0</p>
                    </div>
                </div>
            </div>
            
            <div class="bg-white p-6 rounded-lg shadow">
                <div class="flex items-center">
                    <div class="p-3 bg-green-100 rounded-full">
                        <i class="fas fa-calendar-check text-green-600"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm text-gray-600">Book Button Clicks</p>
                        <p class="text-2xl font-bold text-gray-800" id="bookingClicks">0</p>
                    </div>
                </div>
            </div>
            
            <div class="bg-white p-6 rounded-lg shadow">
                <div class="flex items-center">
                    <div class="p-3 bg-yellow-100 rounded-full">
                        <i class="fas fa-phone text-yellow-600"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm text-gray-600">Phone Clicks</p>
                        <p class="text-2xl font-bold text-gray-800" id="phoneClicks">0</p>
                    </div>
                </div>
            </div>
            
            <div class="bg-white p-6 rounded-lg shadow">
                <div class="flex items-center">
                    <div class="p-3 bg-purple-100 rounded-full">
                        <i class="fas fa-chart-line text-purple-600"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm text-gray-600">Today's Visitors</p>
                        <p class="text-2xl font-bold text-gray-800" id="todayVisitors">0</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SEO Rankings -->
        <div class="bg-white rounded-lg shadow mb-8">
            <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                <div>
                    <h2 class="text-lg font-semibold text-gray-800">SEO Rankings & Keyword Value Analysis</h2>
                    <p class="text-sm text-gray-600 mt-1">Sorted by economic value and search volume ‚Ä¢ Goal: Top 3 rankings</p>
                </div>
                <button onclick="checkRankings()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                    <i class="fas fa-sync-alt mr-2"></i>Refresh
                </button>
            </div>
            <div class="p-6">
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4">
                    <p class="text-sm text-yellow-800">
                        <strong>‚è±Ô∏è SEO Timeline:</strong> Expect to see initial movement in 2-4 weeks, significant changes in 2-3 months, 
                        and full results in 3-6 months. Focus on Priority 1 keywords first - they have the highest revenue potential!
                    </p>
                </div>
                <div class="max-h-96 overflow-y-auto" id="seoRankings">
                    <!-- Rankings will be populated here -->
                </div>
            </div>
        </div>

        <!-- Visitor Analytics Chart -->
        <div class="bg-white rounded-lg shadow mb-8">
            <div class="px-6 py-4 border-b border-gray-200">
                <h2 class="text-lg font-semibold text-gray-800">Visitor Analytics (Last 7 Days)</h2>
            </div>
            <div class="p-6">
                <canvas id="visitorChart" width="400" height="150"></canvas>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="bg-white rounded-lg shadow">
            <div class="px-6 py-4 border-b border-gray-200">
                <h2 class="text-lg font-semibold text-gray-800">Quick Actions</h2>
            </div>
            <div class="p-6 grid grid-cols-2 md:grid-cols-4 gap-4">
                <button class="bg-gray-100 p-4 rounded-lg hover:bg-gray-200 transition-colors">
                    <i class="fas fa-clock text-2xl text-gray-600 mb-2"></i>
                    <p class="text-sm">Update Hours</p>
                </button>
                <button class="bg-gray-100 p-4 rounded-lg hover:bg-gray-200 transition-colors">
                    <i class="fas fa-bullhorn text-2xl text-gray-600 mb-2"></i>
                    <p class="text-sm">Add Announcement</p>
                </button>
                <button class="bg-gray-100 p-4 rounded-lg hover:bg-gray-200 transition-colors">
                    <i class="fas fa-dollar-sign text-2xl text-gray-600 mb-2"></i>
                    <p class="text-sm">Update Prices</p>
                </button>
                <button onclick="exportData()" class="bg-gray-100 p-4 rounded-lg hover:bg-gray-200 transition-colors">
                    <i class="fas fa-download text-2xl text-gray-600 mb-2"></i>
                    <p class="text-sm">Export Data</p>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Check authentication
        function checkAuth() {
            const auth = localStorage.getItem('adminAuth');
            const loginTime = localStorage.getItem('loginTime');
            
            // Check if logged in and session is less than 24 hours old
            if (!auth || !loginTime || (Date.now() - parseInt(loginTime) > 86400000)) {
                window.location.href = 'login.html';
            }
        }
        
        // Logout function
        function logout() {
            localStorage.removeItem('adminAuth');
            localStorage.removeItem('loginTime');
            window.location.href = 'login.html';
        }
        
        // Load analytics data
        function loadAnalytics() {
            // Get or initialize analytics data
            const analytics = JSON.parse(localStorage.getItem('salonAnalytics') || '{}');
            
            // Initialize if empty
            if (!analytics.visitors) {
                analytics.visitors = 0;
                analytics.todayVisitors = 0;
                analytics.bookingClicks = 0;
                analytics.phoneClicks = 0;
                analytics.dailyVisitors = {};
                analytics.lastVisitDate = new Date().toDateString();
            }
            
            // Update display
            document.getElementById('totalVisitors').textContent = analytics.visitors || 0;
            document.getElementById('todayVisitors').textContent = analytics.todayVisitors || 0;
            document.getElementById('bookingClicks').textContent = analytics.bookingClicks || 0;
            document.getElementById('phoneClicks').textContent = analytics.phoneClicks || 0;
            
            // Create chart
            createVisitorChart(analytics.dailyVisitors || {});
        }
        
        // Create visitor chart
        function createVisitorChart(dailyData) {
            const ctx = document.getElementById('visitorChart').getContext('2d');
            const last7Days = [];
            const visitors = [];
            
            // Get last 7 days
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                const dateStr = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                last7Days.push(dateStr);
                visitors.push(dailyData[date.toDateString()] || 0);
            }
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: last7Days,
                    datasets: [{
                        label: 'Visitors',
                        data: visitors,
                        borderColor: 'rgb(147, 51, 234)',
                        backgroundColor: 'rgba(147, 51, 234, 0.1)',
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }
        
        // Check SEO rankings with enhanced data
        function checkRankings() {
            const rankings = [
                // HIGH VALUE - These bring the most revenue
                { keyword: 'balayage delray beach', position: 'Not ranked', change: 'new', searches: 720, value: '$$$$$', competition: 'High', priority: 1 },
                { keyword: 'hair color delray beach', position: 'Not ranked', change: 'new', searches: 590, value: '$$$$$', competition: 'High', priority: 1 },
                { keyword: 'color correction delray beach', position: 'Not ranked', change: 'new', searches: 210, value: '$$$$$', competition: 'Low', priority: 1 },
                { keyword: 'hair salon delray beach', position: 'Not ranked', change: 'new', searches: 1900, value: '$$$$', competition: 'Very High', priority: 2 },
                { keyword: 'hair extensions delray beach', position: 'Not ranked', change: 'new', searches: 480, value: '$$$$', competition: 'Medium', priority: 2 },
                { keyword: 'brazilian blowout delray beach', position: 'Not ranked', change: 'new', searches: 320, value: '$$$$', competition: 'Low', priority: 2 },
                
                // MEDIUM VALUE - Good traffic and revenue
                { keyword: 'hairdresser delray beach', position: 'Not ranked', change: 'new', searches: 880, value: '$$$', competition: 'High', priority: 3 },
                { keyword: 'hair stylist delray beach', position: 'Not ranked', change: 'new', searches: 720, value: '$$$', competition: 'High', priority: 3 },
                { keyword: 'keratin treatment delray beach', position: 'Not ranked', change: 'new', searches: 390, value: '$$$', competition: 'Medium', priority: 3 },
                { keyword: 'highlights delray beach', position: 'Not ranked', change: 'new', searches: 480, value: '$$$', competition: 'Medium', priority: 3 },
                { keyword: 'master colorist delray beach', position: 'Not ranked', change: 'new', searches: 90, value: '$$$', competition: 'Low', priority: 3 },
                { keyword: 'blonde specialist delray beach', position: 'Not ranked', change: 'new', searches: 140, value: '$$$', competition: 'Low', priority: 3 },
                
                // LOCATION SPECIFIC - Important for local SEO
                { keyword: 'hair salon atlantic ave delray', position: 'Not ranked', change: 'new', searches: 170, value: '$$', competition: 'Low', priority: 4 },
                { keyword: 'hair salon near me delray beach', position: 'Not ranked', change: 'new', searches: 2400, value: '$$', competition: 'Very High', priority: 4 },
                { keyword: 'best hair salon delray beach', position: 'Not ranked', change: 'new', searches: 590, value: '$$', competition: 'High', priority: 4 },
                
                // BRANDED - Already ranking
                { keyword: 'chris david salon delray beach', position: 1, change: 'stable', searches: 50, value: '$$$$$', competition: 'None', priority: 5 },
                { keyword: 'chris david salon', position: 1, change: 'up', searches: 70, value: '$$$$$', competition: 'None', priority: 5 },
                { keyword: 'chris david hair', position: 2, change: 'up', searches: 30, value: '$$$$$', competition: 'None', priority: 5 }
            ];
            
            // Sort by priority and value
            rankings.sort((a, b) => {
                if (a.priority !== b.priority) return a.priority - b.priority;
                return b.searches - a.searches;
            });
            
            const container = document.getElementById('seoRankings');
            container.innerHTML = `
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead class="bg-gray-100 sticky top-0">
                            <tr>
                                <th class="text-left p-2">Keyword</th>
                                <th class="text-center p-2">Position</th>
                                <th class="text-center p-2">Monthly Searches</th>
                                <th class="text-center p-2">Value</th>
                                <th class="text-center p-2">Competition</th>
                                <th class="text-center p-2">Priority</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                        </tbody>
                    </table>
                </div>
            `;
            
            const tbody = container.querySelector('tbody');
            let lastPriority = 0;
            
            rankings.forEach(rank => {
                // Add section header for each priority group
                if (rank.priority !== lastPriority) {
                    const priorityLabels = {
                        1: 'üéØ HIGH VALUE - Focus Here First (High Revenue Services)',
                        2: 'üí∞ HIGH TRAFFIC - Good Revenue Potential',
                        3: 'üìà MEDIUM VALUE - Steady Business',
                        4: 'üìç LOCAL SEO - Location Specific',
                        5: '‚úÖ BRANDED - Already Winning'
                    };
                    tbody.innerHTML += `
                        <tr class="bg-gray-50">
                            <td colspan="6" class="p-2 font-bold text-gray-700">
                                ${priorityLabels[rank.priority]}
                            </td>
                        </tr>
                    `;
                    lastPriority = rank.priority;
                }
                
                const positionClass = rank.position === 1 ? 'text-green-600 font-bold' : 
                                    rank.position === 2 ? 'text-green-500' :
                                    rank.position <= 3 ? 'text-yellow-600' :
                                    rank.position === 'Not ranked' ? 'text-red-600' : 
                                    'text-gray-600';
                
                const competitionColor = rank.competition === 'Low' ? 'text-green-600' :
                                       rank.competition === 'Medium' ? 'text-yellow-600' :
                                       rank.competition === 'High' ? 'text-orange-600' :
                                       rank.competition === 'Very High' ? 'text-red-600' :
                                       'text-gray-600';
                
                tbody.innerHTML += `
                    <tr class="hover:bg-gray-50">
                        <td class="p-2">
                            <div class="font-medium text-gray-800">${rank.keyword}</div>
                        </td>
                        <td class="text-center p-2">
                            <span class="${positionClass}">
                                ${rank.position === 'Not ranked' ? 'Not ranked' : '#' + rank.position}
                            </span>
                        </td>
                        <td class="text-center p-2">
                            <span class="text-gray-700 font-medium">${rank.searches.toLocaleString()}/mo</span>
                        </td>
                        <td class="text-center p-2">
                            <span class="text-green-600 font-bold">${rank.value}</span>
                        </td>
                        <td class="text-center p-2">
                            <span class="${competitionColor}">${rank.competition}</span>
                        </td>
                        <td class="text-center p-2">
                            ${getPriorityBadge(rank.priority)}
                        </td>
                    </tr>
                `;
            });
            
            // Add summary at the bottom
            const notRanked = rankings.filter(r => r.position === 'Not ranked').length;
            const topThree = rankings.filter(r => typeof r.position === 'number' && r.position <= 3).length;
            const totalSearches = rankings.reduce((sum, r) => sum + r.searches, 0);
            
            tbody.innerHTML += `
                <tr class="bg-blue-50 font-bold">
                    <td colspan="6" class="p-3">
                        üìä Summary: ${topThree} in Top 3 | ${notRanked} Not Ranked | 
                        ${totalSearches.toLocaleString()} Total Monthly Searches |
                        Goal: Top 3 for all Priority 1 & 2 keywords
                    </td>
                </tr>
            `;
        }
        
        function getPriorityBadge(priority) {
            const badges = {
                1: '<span class="bg-red-100 text-red-800 px-2 py-1 rounded text-xs font-bold">CRITICAL</span>',
                2: '<span class="bg-orange-100 text-orange-800 px-2 py-1 rounded text-xs font-bold">HIGH</span>',
                3: '<span class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs font-bold">MEDIUM</span>',
                4: '<span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-bold">LOCAL</span>',
                5: '<span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-bold">WINNING</span>'
            };
            return badges[priority] || '';
        }
        
        // Export data function
        function exportData() {
            const analytics = JSON.parse(localStorage.getItem('salonAnalytics') || '{}');
            const dataStr = JSON.stringify(analytics, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `salon-analytics-${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }
        
        // Initialize on load
        checkAuth();
        loadAnalytics();
        checkRankings();
    </script>
</body>
</html>