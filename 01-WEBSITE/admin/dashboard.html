<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Chris David Salon</title>
    <meta name="robots" content="noindex, nofollow">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gray-100">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <h1 class="text-xl font-bold text-gray-800">Chris David Salon Admin</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="text-sm text-gray-600">Welcome, Admin</span>
                    <button onclick="logout()" class="text-red-600 hover:text-red-700">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
        <!-- Stats Overview -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="bg-white p-6 rounded-lg shadow">
                <div class="flex items-center">
                    <div class="p-3 bg-blue-100 rounded-full">
                        <i class="fas fa-users text-blue-600"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm text-gray-600">Total Visitors</p>
                        <p class="text-2xl font-bold text-gray-800" id="totalVisitors">0</p>
                    </div>
                </div>
            </div>
            
            <div class="bg-white p-6 rounded-lg shadow">
                <div class="flex items-center">
                    <div class="p-3 bg-green-100 rounded-full">
                        <i class="fas fa-calendar-check text-green-600"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm text-gray-600">Book Button Clicks</p>
                        <p class="text-2xl font-bold text-gray-800" id="bookingClicks">0</p>
                    </div>
                </div>
            </div>
            
            <div class="bg-white p-6 rounded-lg shadow">
                <div class="flex items-center">
                    <div class="p-3 bg-yellow-100 rounded-full">
                        <i class="fas fa-phone text-yellow-600"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm text-gray-600">Phone Clicks</p>
                        <p class="text-2xl font-bold text-gray-800" id="phoneClicks">0</p>
                    </div>
                </div>
            </div>
            
            <div class="bg-white p-6 rounded-lg shadow">
                <div class="flex items-center">
                    <div class="p-3 bg-purple-100 rounded-full">
                        <i class="fas fa-chart-line text-purple-600"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm text-gray-600">Today's Visitors</p>
                        <p class="text-2xl font-bold text-gray-800" id="todayVisitors">0</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SEO Rankings -->
        <div class="bg-white rounded-lg shadow mb-8">
            <div class="px-6 py-4 border-b border-gray-200">
                <h2 class="text-lg font-semibold text-gray-800">SEO Rankings</h2>
            </div>
            <div class="p-6">
                <div class="space-y-4" id="seoRankings">
                    <!-- Rankings will be populated here -->
                </div>
                <button onclick="checkRankings()" class="mt-4 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                    <i class="fas fa-sync-alt mr-2"></i>Refresh Rankings
                </button>
            </div>
        </div>

        <!-- Visitor Analytics Chart -->
        <div class="bg-white rounded-lg shadow mb-8">
            <div class="px-6 py-4 border-b border-gray-200">
                <h2 class="text-lg font-semibold text-gray-800">Visitor Analytics (Last 7 Days)</h2>
            </div>
            <div class="p-6">
                <canvas id="visitorChart" width="400" height="150"></canvas>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="bg-white rounded-lg shadow">
            <div class="px-6 py-4 border-b border-gray-200">
                <h2 class="text-lg font-semibold text-gray-800">Quick Actions</h2>
            </div>
            <div class="p-6 grid grid-cols-2 md:grid-cols-4 gap-4">
                <button class="bg-gray-100 p-4 rounded-lg hover:bg-gray-200 transition-colors">
                    <i class="fas fa-clock text-2xl text-gray-600 mb-2"></i>
                    <p class="text-sm">Update Hours</p>
                </button>
                <button class="bg-gray-100 p-4 rounded-lg hover:bg-gray-200 transition-colors">
                    <i class="fas fa-bullhorn text-2xl text-gray-600 mb-2"></i>
                    <p class="text-sm">Add Announcement</p>
                </button>
                <button class="bg-gray-100 p-4 rounded-lg hover:bg-gray-200 transition-colors">
                    <i class="fas fa-dollar-sign text-2xl text-gray-600 mb-2"></i>
                    <p class="text-sm">Update Prices</p>
                </button>
                <button onclick="exportData()" class="bg-gray-100 p-4 rounded-lg hover:bg-gray-200 transition-colors">
                    <i class="fas fa-download text-2xl text-gray-600 mb-2"></i>
                    <p class="text-sm">Export Data</p>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Check authentication
        function checkAuth() {
            const auth = localStorage.getItem('adminAuth');
            const loginTime = localStorage.getItem('loginTime');
            
            // Check if logged in and session is less than 24 hours old
            if (!auth || !loginTime || (Date.now() - parseInt(loginTime) > 86400000)) {
                window.location.href = 'login.html';
            }
        }
        
        // Logout function
        function logout() {
            localStorage.removeItem('adminAuth');
            localStorage.removeItem('loginTime');
            window.location.href = 'login.html';
        }
        
        // Load analytics data
        function loadAnalytics() {
            // Get or initialize analytics data
            const analytics = JSON.parse(localStorage.getItem('salonAnalytics') || '{}');
            
            // Initialize if empty
            if (!analytics.visitors) {
                analytics.visitors = 0;
                analytics.todayVisitors = 0;
                analytics.bookingClicks = 0;
                analytics.phoneClicks = 0;
                analytics.dailyVisitors = {};
                analytics.lastVisitDate = new Date().toDateString();
            }
            
            // Update display
            document.getElementById('totalVisitors').textContent = analytics.visitors || 0;
            document.getElementById('todayVisitors').textContent = analytics.todayVisitors || 0;
            document.getElementById('bookingClicks').textContent = analytics.bookingClicks || 0;
            document.getElementById('phoneClicks').textContent = analytics.phoneClicks || 0;
            
            // Create chart
            createVisitorChart(analytics.dailyVisitors || {});
        }
        
        // Create visitor chart
        function createVisitorChart(dailyData) {
            const ctx = document.getElementById('visitorChart').getContext('2d');
            const last7Days = [];
            const visitors = [];
            
            // Get last 7 days
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                const dateStr = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                last7Days.push(dateStr);
                visitors.push(dailyData[date.toDateString()] || 0);
            }
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: last7Days,
                    datasets: [{
                        label: 'Visitors',
                        data: visitors,
                        borderColor: 'rgb(147, 51, 234)',
                        backgroundColor: 'rgba(147, 51, 234, 0.1)',
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }
        
        // Check SEO rankings
        function checkRankings() {
            const rankings = [
                { keyword: 'chris david salon delray beach', position: 1, change: 'stable', url: 'chrisdavidsalon.com' },
                { keyword: 'chris david salon', position: 1, change: 'up', url: 'chrisdavidsalon.com' },
                { keyword: 'balayage delray beach', position: 'Not ranked', change: 'new', url: '-' },
                { keyword: 'hair salon delray beach', position: 'Not ranked', change: 'new', url: '-' },
                { keyword: 'color correction delray beach', position: 'Not ranked', change: 'new', url: '-' },
                { keyword: 'hair extensions delray beach', position: 'Not ranked', change: 'new', url: '-' },
                { keyword: 'keratin treatment delray beach', position: 'Not ranked', change: 'new', url: '-' },
                { keyword: 'master colorist delray beach', position: 'Not ranked', change: 'new', url: '-' }
            ];
            
            const container = document.getElementById('seoRankings');
            container.innerHTML = '';
            
            rankings.forEach(rank => {
                const positionClass = rank.position === 1 ? 'text-green-600' : 
                                    rank.position === 'Not ranked' ? 'text-red-600' : 
                                    'text-yellow-600';
                
                const changeIcon = rank.change === 'up' ? '↑' : 
                                  rank.change === 'down' ? '↓' : 
                                  rank.change === 'stable' ? '→' : '•';
                
                container.innerHTML += `
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                        <div>
                            <p class="font-medium text-gray-800">${rank.keyword}</p>
                            <p class="text-sm text-gray-600">${rank.url}</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="${positionClass} font-bold">
                                ${rank.position === 'Not ranked' ? 'Not ranked' : '#' + rank.position}
                            </span>
                            <span class="text-gray-500">${changeIcon}</span>
                        </div>
                    </div>
                `;
            });
        }
        
        // Export data function
        function exportData() {
            const analytics = JSON.parse(localStorage.getItem('salonAnalytics') || '{}');
            const dataStr = JSON.stringify(analytics, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `salon-analytics-${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }
        
        // Initialize on load
        checkAuth();
        loadAnalytics();
        checkRankings();
    </script>
</body>
</html>