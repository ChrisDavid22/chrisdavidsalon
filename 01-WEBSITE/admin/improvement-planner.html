<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <title>SEO Improvement Plan - Chris David Salon</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="shared-nav.js"></script>
</head>
<body class="bg-gray-100">
    <!-- Shared Navigation -->
    <div id="admin-nav" data-page="improvement"></div>

    <div class="max-w-7xl mx-auto p-6">

        <!-- Current Status Banner -->
        <div id="statusBanner" class="bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-xl shadow-xl p-6 mb-6">
            <div class="flex items-start justify-between">
                <div>
                    <h1 class="text-2xl font-bold mb-2">SEO Improvement Plan</h1>
                    <p class="text-orange-100">Data-driven recommendations based on your actual search performance</p>
                </div>
                <div class="text-right">
                    <div class="text-4xl font-bold" id="overallGrade">C</div>
                    <div class="text-sm text-orange-200">Current SEO Grade</div>
                </div>
            </div>
        </div>

        <!-- Key Metrics Summary -->
        <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6">
            <div class="bg-white rounded-xl shadow p-4 text-center">
                <div class="text-sm text-gray-500">Avg Position</div>
                <div class="text-3xl font-bold text-red-600" id="avgPosition">--</div>
                <div class="text-xs text-gray-400">Goal: &lt;10</div>
            </div>
            <div class="bg-white rounded-xl shadow p-4 text-center">
                <div class="text-sm text-gray-500">Total Clicks</div>
                <div class="text-3xl font-bold text-orange-600" id="totalClicks">--</div>
                <div class="text-xs text-gray-400">Last 28 days</div>
            </div>
            <div class="bg-white rounded-xl shadow p-4 text-center">
                <div class="text-sm text-gray-500">Impressions</div>
                <div class="text-3xl font-bold text-blue-600" id="totalImpressions">--</div>
                <div class="text-xs text-gray-400">Search appearances</div>
            </div>
            <div class="bg-white rounded-xl shadow p-4 text-center">
                <div class="text-sm text-gray-500">Click Rate</div>
                <div class="text-3xl font-bold text-purple-600" id="avgCTR">--%</div>
                <div class="text-xs text-gray-400">Goal: 15%+</div>
            </div>
            <div class="bg-white rounded-xl shadow p-4 text-center">
                <div class="text-sm text-gray-500">Keywords</div>
                <div class="text-3xl font-bold text-green-600" id="totalKeywords">--</div>
                <div class="text-xs text-gray-400">You rank for</div>
            </div>
        </div>

        <!-- The Problem Section -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
            <h2 class="text-xl font-bold text-red-700 mb-4 flex items-center gap-2">
                <i class="fas fa-exclamation-triangle"></i>
                The Problem: You're Invisible for High-Value Keywords
            </h2>
            <p class="text-gray-700 mb-4">
                When someone in Delray Beach searches for a hair salon, Chris David Salon appears on <strong>page 3</strong> (position 25+).
                <strong>90% of clicks go to the top 3 results.</strong> Page 3 = essentially invisible.
            </p>
            <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                <h3 class="font-semibold text-red-800 mb-2">Your Biggest Missed Opportunities:</h3>
                <div id="missedOpportunities" class="space-y-2">
                    <div class="text-gray-500">Loading keyword data...</div>
                </div>
            </div>
        </div>

        <!-- COLOR STRATEGY - Chris's Competitive Advantage -->
        <div class="bg-gradient-to-r from-purple-600 to-indigo-700 text-white rounded-xl shadow-xl p-6 mb-6">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
                <i class="fas fa-crown text-yellow-400"></i>
                #1 PRIORITY: Dominate Hair Color Keywords
            </h2>
            <p class="text-purple-100 mb-4">
                Chris is a <strong>world-class colorist</strong> - trained for 5 major brands, taught hundreds of pros.
                But Google doesn't know this yet. Here are the <strong>highest-volume color keywords</strong> to target.
            </p>

            <div class="bg-white/10 rounded-lg p-4 mb-4">
                <h3 class="font-bold text-yellow-400 mb-2">Keyword Search Volume (Monthly US Searches):</h3>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm">
                    <div class="bg-green-500/30 rounded p-2"><strong>"balayage near me"</strong><br><span class="text-green-300">40,000+/mo</span></div>
                    <div class="bg-green-500/30 rounded p-2"><strong>"highlights near me"</strong><br><span class="text-green-300">30,000+/mo</span></div>
                    <div class="bg-green-500/30 rounded p-2"><strong>"hair color near me"</strong><br><span class="text-green-300">25,000+/mo</span></div>
                    <div class="bg-yellow-500/30 rounded p-2"><strong>"blonde hair salon"</strong><br><span class="text-yellow-300">15,000+/mo</span></div>
                    <div class="bg-yellow-500/30 rounded p-2"><strong>"ombre hair near me"</strong><br><span class="text-yellow-300">10,000+/mo</span></div>
                    <div class="bg-orange-500/30 rounded p-2"><strong>"color correction"</strong><br><span class="text-orange-300">2,400/mo (but $300+ ticket)</span></div>
                </div>
            </div>

            <!-- Current Rankings -->
            <div class="bg-white/10 rounded-lg p-4 mb-4">
                <h3 class="font-bold text-green-400 mb-2"><i class="fas fa-check-circle mr-2"></i>Already Ranking (Protect These!):</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-2 text-sm">
                    <div class="bg-green-500/20 rounded p-2">"grey blending expert near me" <span class="text-green-300">#1</span></div>
                    <div class="bg-yellow-500/20 rounded p-2">"grey blending near me" <span class="text-yellow-300">#6.9</span></div>
                    <div class="bg-yellow-500/20 rounded p-2">"best color specialist near me" <span class="text-yellow-300">#8</span></div>
                    <div class="bg-yellow-500/20 rounded p-2">"goldwell salons near me" <span class="text-yellow-300">#8</span></div>
                    <div class="bg-yellow-500/20 rounded p-2">"best blonde colorist near me" <span class="text-yellow-300">#9</span></div>
                </div>
            </div>

            <h3 class="font-bold text-yellow-400 mb-3"><i class="fas fa-fire text-orange-400 mr-2"></i>HIGH VOLUME - Target These First:</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-4">
                <a href="https://www.google.com/search?q=balayage+delray+beach" target="_blank"
                   class="flex justify-between items-center bg-green-500/20 rounded p-3 hover:bg-green-500/30 border border-green-400/30">
                    <span><strong>"balayage delray beach"</strong> <span class="text-green-300 text-xs">HIGH VOL</span></span>
                    <i class="fas fa-external-link-alt text-xs"></i>
                </a>
                <a href="https://www.google.com/search?q=balayage+boca+raton" target="_blank"
                   class="flex justify-between items-center bg-green-500/20 rounded p-3 hover:bg-green-500/30 border border-green-400/30">
                    <span><strong>"balayage boca raton"</strong> <span class="text-green-300 text-xs">HIGH VOL</span></span>
                    <i class="fas fa-external-link-alt text-xs"></i>
                </a>
                <a href="https://www.google.com/search?q=highlights+delray+beach" target="_blank"
                   class="flex justify-between items-center bg-green-500/20 rounded p-3 hover:bg-green-500/30 border border-green-400/30">
                    <span><strong>"highlights delray beach"</strong> <span class="text-green-300 text-xs">HIGH VOL</span></span>
                    <i class="fas fa-external-link-alt text-xs"></i>
                </a>
                <a href="https://www.google.com/search?q=highlights+boca+raton" target="_blank"
                   class="flex justify-between items-center bg-green-500/20 rounded p-3 hover:bg-green-500/30 border border-green-400/30">
                    <span><strong>"highlights boca raton"</strong> <span class="text-green-300 text-xs">HIGH VOL</span></span>
                    <i class="fas fa-external-link-alt text-xs"></i>
                </a>
                <a href="https://www.google.com/search?q=hair+color+delray+beach" target="_blank"
                   class="flex justify-between items-center bg-green-500/20 rounded p-3 hover:bg-green-500/30 border border-green-400/30">
                    <span><strong>"hair color delray beach"</strong> <span class="text-green-300 text-xs">HIGH VOL</span></span>
                    <i class="fas fa-external-link-alt text-xs"></i>
                </a>
                <a href="https://www.google.com/search?q=blonde+specialist+delray+beach" target="_blank"
                   class="flex justify-between items-center bg-green-500/20 rounded p-3 hover:bg-green-500/30 border border-green-400/30">
                    <span><strong>"blonde specialist delray beach"</strong> <span class="text-green-300 text-xs">HIGH VOL</span></span>
                    <i class="fas fa-external-link-alt text-xs"></i>
                </a>
                <a href="https://www.google.com/search?q=ombre+hair+delray+beach" target="_blank"
                   class="flex justify-between items-center bg-yellow-500/20 rounded p-3 hover:bg-yellow-500/30 border border-yellow-400/30">
                    <span>"ombre hair delray beach" <span class="text-yellow-300 text-xs">MED VOL</span></span>
                    <i class="fas fa-external-link-alt text-xs"></i>
                </a>
                <a href="https://www.google.com/search?q=hair+colorist+delray+beach" target="_blank"
                   class="flex justify-between items-center bg-yellow-500/20 rounded p-3 hover:bg-yellow-500/30 border border-yellow-400/30">
                    <span>"hair colorist delray beach" <span class="text-yellow-300 text-xs">MED VOL</span></span>
                    <i class="fas fa-external-link-alt text-xs"></i>
                </a>
            </div>

            <h3 class="font-bold text-yellow-400 mb-3">Color Correction (Lower volume, but $300+ per service):</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-4">
                <a href="https://www.google.com/search?q=color+correction+delray+beach" target="_blank"
                   class="flex justify-between items-center bg-white/10 rounded p-3 hover:bg-white/20">
                    <span>"color correction delray beach"</span>
                    <i class="fas fa-external-link-alt text-xs"></i>
                </a>
                <a href="https://www.google.com/search?q=fix+brassy+hair+delray+beach" target="_blank"
                   class="flex justify-between items-center bg-white/10 rounded p-3 hover:bg-white/20">
                    <span>"fix brassy hair delray beach"</span>
                    <i class="fas fa-external-link-alt text-xs"></i>
                </a>
                <a href="https://www.google.com/search?q=fix+orange+hair+near+me" target="_blank"
                   class="flex justify-between items-center bg-white/10 rounded p-3 hover:bg-white/20">
                    <span>"fix orange hair near me"</span>
                    <i class="fas fa-external-link-alt text-xs"></i>
                </a>
                <a href="https://www.google.com/search?q=box+dye+fix+near+me" target="_blank"
                   class="flex justify-between items-center bg-white/10 rounded p-3 hover:bg-white/20">
                    <span>"box dye fix near me"</span>
                    <i class="fas fa-external-link-alt text-xs"></i>
                </a>
            </div>

            <h3 class="font-bold text-yellow-400 mb-3">Brand Keywords (Chris's Differentiator):</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-4">
                <a href="https://www.google.com/search?q=davines+salon+florida" target="_blank"
                   class="flex justify-between items-center bg-white/10 rounded p-3 hover:bg-white/20">
                    <span>"davines salon florida"</span>
                    <i class="fas fa-external-link-alt text-xs"></i>
                </a>
                <a href="https://www.google.com/search?q=goldwell+salon+delray+beach" target="_blank"
                   class="flex justify-between items-center bg-white/10 rounded p-3 hover:bg-white/20">
                    <span>"goldwell salon delray beach"</span>
                    <i class="fas fa-external-link-alt text-xs"></i>
                </a>
                <a href="https://www.google.com/search?q=organic+hair+color+delray+beach" target="_blank"
                   class="flex justify-between items-center bg-white/10 rounded p-3 hover:bg-white/20">
                    <span>"organic hair color delray beach"</span>
                    <i class="fas fa-external-link-alt text-xs"></i>
                </a>
                <a href="https://www.google.com/search?q=master+colorist+south+florida" target="_blank"
                   class="flex justify-between items-center bg-white/10 rounded p-3 hover:bg-white/20">
                    <span>"master colorist south florida"</span>
                    <i class="fas fa-external-link-alt text-xs"></i>
                </a>
            </div>

            <h3 class="font-bold text-yellow-400 mb-3">Action Plan for Color Dominance:</h3>
            <div class="space-y-2">
                <div class="flex items-start gap-3 bg-white/10 rounded p-3">
                    <span class="bg-yellow-400 text-purple-900 w-6 h-6 rounded-full flex items-center justify-center font-bold flex-shrink-0">1</span>
                    <div>
                        <strong>Optimize existing color correction page</strong>
                        <p class="text-sm text-purple-200">Page exists at /services/color-correction-delray-beach.html - add more keywords, internal links</p>
                    </div>
                </div>
                <div class="flex items-start gap-3 bg-white/10 rounded p-3">
                    <span class="bg-yellow-400 text-purple-900 w-6 h-6 rounded-full flex items-center justify-center font-bold flex-shrink-0">2</span>
                    <div>
                        <strong>Add color correction to Google Business Profile</strong>
                        <p class="text-sm text-purple-200">List "Color Correction" as a primary service with full description</p>
                    </div>
                </div>
                <div class="flex items-start gap-3 bg-white/10 rounded p-3">
                    <span class="bg-yellow-400 text-purple-900 w-6 h-6 rounded-full flex items-center justify-center font-bold flex-shrink-0">3</span>
                    <div>
                        <strong>Create before/after gallery page</strong>
                        <p class="text-sm text-purple-200">Nothing sells color correction like dramatic transformations</p>
                    </div>
                </div>
                <div class="flex items-start gap-3 bg-white/10 rounded p-3">
                    <span class="bg-yellow-400 text-purple-900 w-6 h-6 rounded-full flex items-center justify-center font-bold flex-shrink-0">4</span>
                    <div>
                        <strong>Ask color correction clients for keyword-rich reviews</strong>
                        <p class="text-sm text-purple-200">"Chris fixed my color correction..." - reviews with keywords boost rankings</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Priority Actions -->
        <div class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl shadow-lg p-6 mb-6">
            <h2 class="text-xl font-bold text-green-800 mb-4 flex items-center gap-2">
                <i class="fas fa-rocket"></i>
                Other Priority Actions
            </h2>
            <p class="text-green-700 mb-4">Additional actions based on your Search Console data.</p>

            <div id="priorityActions" class="space-y-4">
                <div class="text-gray-500 text-center py-4">Loading recommendations...</div>
            </div>
        </div>

        <!-- Keyword Strategy -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                <i class="fas fa-key text-yellow-500"></i>
                Keyword Strategy: What Pages to Build
            </h2>

            <div class="grid md:grid-cols-3 gap-6">
                <!-- Already Winning -->
                <div class="border-2 border-green-200 rounded-lg p-4">
                    <h3 class="font-bold text-green-700 mb-3 flex items-center gap-2">
                        <i class="fas fa-check-circle"></i>
                        Already Winning (Maintain)
                    </h3>
                    <p class="text-sm text-gray-600 mb-3">Position 1-3. Keep doing what you're doing.</p>
                    <div id="winningKeywords" class="space-y-2">
                        <div class="text-gray-400 text-sm">Loading...</div>
                    </div>
                </div>

                <!-- Almost There -->
                <div class="border-2 border-yellow-200 rounded-lg p-4">
                    <h3 class="font-bold text-yellow-700 mb-3 flex items-center gap-2">
                        <i class="fas fa-arrow-up"></i>
                        Almost There (Optimize)
                    </h3>
                    <p class="text-sm text-gray-600 mb-3">Position 4-10. Small improvements = big gains.</p>
                    <div id="almostKeywords" class="space-y-2">
                        <div class="text-gray-400 text-sm">Loading...</div>
                    </div>
                </div>

                <!-- Big Opportunities -->
                <div class="border-2 border-orange-200 rounded-lg p-4">
                    <h3 class="font-bold text-orange-700 mb-3 flex items-center gap-2">
                        <i class="fas fa-bullseye"></i>
                        Create New Pages For
                    </h3>
                    <p class="text-sm text-gray-600 mb-3">Position 11+. Need dedicated landing pages.</p>
                    <div id="opportunityKeywords" class="space-y-2">
                        <div class="text-gray-400 text-sm">Loading...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Suggested New Pages -->
        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl shadow-lg p-6 mb-6">
            <h2 class="text-xl font-bold text-blue-800 mb-4 flex items-center gap-2">
                <i class="fas fa-file-alt"></i>
                Recommended New Pages to Build
            </h2>
            <p class="text-blue-700 mb-4">Based on your Search Console data, these pages would capture traffic you're currently missing:</p>

            <div id="suggestedPages" class="grid md:grid-cols-2 gap-4">
                <div class="text-gray-500 text-center py-4">Loading suggestions...</div>
            </div>
        </div>

        <!-- Quick Wins Checklist -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                <i class="fas fa-tasks text-purple-500"></i>
                Quick Wins Checklist
            </h2>
            <p class="text-gray-600 mb-4">These don't require building new pages - just optimization.</p>

            <div class="grid md:grid-cols-2 gap-4" id="quickWins">
                <!-- Will be populated by JS -->
            </div>
        </div>

        <!-- Review Strategy -->
        <div class="bg-gradient-to-r from-yellow-50 to-amber-50 rounded-xl shadow-lg p-6 mb-6">
            <h2 class="text-xl font-bold text-yellow-800 mb-4 flex items-center gap-2">
                <i class="fas fa-star"></i>
                Review Strategy (15-20% of Local Rankings)
            </h2>
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <h3 class="font-semibold text-yellow-700 mb-2">Current Status:</h3>
                    <div class="bg-white rounded-lg p-4 border border-yellow-200">
                        <div class="text-3xl font-bold text-yellow-600" id="currentReviews">--</div>
                        <div class="text-sm text-gray-600">Google Reviews</div>
                        <div class="mt-2 text-sm text-gray-500">Rating: <span id="currentRating">--</span>/5</div>
                    </div>
                </div>
                <div>
                    <h3 class="font-semibold text-yellow-700 mb-2">Action Items:</h3>
                    <ul class="space-y-2">
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <span>Ask 3 happy clients for reviews this week</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <span>Respond to ALL reviews within 24 hours</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-green-500 mt-1"></i>
                            <span>Create a review request card/text template</span>
                        </li>
                    </ul>
                    <a href="https://search.google.com/local/writereview?placeid=ChIJxTZ8If_f2IgR2XMxX_zRKSg"
                       target="_blank"
                       class="mt-3 inline-block bg-yellow-500 text-white px-4 py-2 rounded font-semibold text-sm hover:bg-yellow-600">
                        <i class="fas fa-external-link-alt mr-2"></i>Get Review Link
                    </a>
                </div>
            </div>
        </div>

        <!-- Timeline -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                <i class="fas fa-calendar-alt text-indigo-500"></i>
                Recommended Action Timeline
            </h2>

            <div class="space-y-4">
                <div class="flex gap-4">
                    <div class="w-24 flex-shrink-0">
                        <div class="bg-red-100 text-red-700 font-bold py-2 px-3 rounded text-center">Week 1</div>
                    </div>
                    <div class="flex-1 bg-red-50 rounded-lg p-4">
                        <h4 class="font-semibold text-red-800">Fix the Foundations</h4>
                        <ul class="text-sm text-gray-700 mt-2 space-y-1">
                            <li>• Optimize Google Business Profile (complete all fields, add photos)</li>
                            <li>• Fix title tags on existing pages to include "Delray Beach"</li>
                            <li>• Ask 5 recent clients for Google reviews</li>
                        </ul>
                    </div>
                </div>

                <div class="flex gap-4">
                    <div class="w-24 flex-shrink-0">
                        <div class="bg-orange-100 text-orange-700 font-bold py-2 px-3 rounded text-center">Week 2-3</div>
                    </div>
                    <div class="flex-1 bg-orange-50 rounded-lg p-4">
                        <h4 class="font-semibold text-orange-800">Build High-Priority Pages</h4>
                        <ul class="text-sm text-gray-700 mt-2 space-y-1">
                            <li>• Create "Best Hair Salon Delray Beach" landing page</li>
                            <li>• Optimize existing "Balayage Delray Beach" page</li>
                            <li>• Add schema markup to all service pages</li>
                        </ul>
                    </div>
                </div>

                <div class="flex gap-4">
                    <div class="w-24 flex-shrink-0">
                        <div class="bg-yellow-100 text-yellow-700 font-bold py-2 px-3 rounded text-center">Week 4</div>
                    </div>
                    <div class="flex-1 bg-yellow-50 rounded-lg p-4">
                        <h4 class="font-semibold text-yellow-800">Build Authority</h4>
                        <ul class="text-sm text-gray-700 mt-2 space-y-1">
                            <li>• Get listed on 5 local directories (Yelp, YP, etc.)</li>
                            <li>• Reach out to local bloggers for features</li>
                            <li>• Continue review generation (target 10+ new reviews)</li>
                        </ul>
                    </div>
                </div>

                <div class="flex gap-4">
                    <div class="w-24 flex-shrink-0">
                        <div class="bg-green-100 text-green-700 font-bold py-2 px-3 rounded text-center">Ongoing</div>
                    </div>
                    <div class="flex-1 bg-green-50 rounded-lg p-4">
                        <h4 class="font-semibold text-green-800">Maintain & Monitor</h4>
                        <ul class="text-sm text-gray-700 mt-2 space-y-1">
                            <li>• Post to Google Business Profile weekly</li>
                            <li>• Check rankings monthly and adjust strategy</li>
                            <li>• Keep asking for reviews (velocity matters)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
    const API_BASE = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
        ? 'https://www.chrisdavidsalon.com'
        : '';

    let keywordsData = [];

    async function loadAllData() {
        // Load version
        try {
            const versionResp = await fetch(`${API_BASE}/data/version.json`);
            const versionData = await versionResp.json();
            document.getElementById('versionBadge').textContent = 'v' + versionData.version;
        } catch (e) {
            document.getElementById('versionBadge').textContent = 'v?.?.?';
        }
        document.getElementById('lastUpdate').textContent = 'Updated: ' + new Date().toLocaleTimeString();

        // Load Search Console data
        await loadSearchConsoleData();

        // Load competitor data for reviews
        await loadCompetitorData();

        // Render quick wins
        renderQuickWins();
    }

    async function loadSearchConsoleData() {
        try {
            const response = await fetch(`${API_BASE}/api/ga4-analytics?type=search-rankings`);
            const result = await response.json();

            if (result.success) {
                // Update metrics
                document.getElementById('avgPosition').textContent = result.summary.averagePosition;
                document.getElementById('totalClicks').textContent = result.summary.totalClicks;
                document.getElementById('totalImpressions').textContent = result.summary.totalImpressions;
                document.getElementById('avgCTR').textContent = result.summary.averageCTR + '%';
                document.getElementById('totalKeywords').textContent = result.summary.totalKeywords;

                // Calculate grade
                const avgPos = parseFloat(result.summary.averagePosition);
                let grade = 'F';
                let gradeColor = 'from-red-500 to-red-600';
                if (avgPos <= 3) { grade = 'A'; gradeColor = 'from-green-500 to-green-600'; }
                else if (avgPos <= 10) { grade = 'B'; gradeColor = 'from-green-400 to-yellow-500'; }
                else if (avgPos <= 20) { grade = 'C'; gradeColor = 'from-yellow-500 to-orange-500'; }
                else if (avgPos <= 30) { grade = 'D'; gradeColor = 'from-orange-500 to-red-500'; }

                document.getElementById('overallGrade').textContent = grade;
                document.getElementById('statusBanner').className = `bg-gradient-to-r ${gradeColor} text-white rounded-xl shadow-xl p-6 mb-6`;

                // Process keywords
                keywordsData = result.topKeywords;

                // Render sections
                renderMissedOpportunities();
                renderKeywordCategories();
                renderPriorityActions();
                renderSuggestedPages();
            }
        } catch (error) {
            console.error('Search Console error:', error);
        }
    }

    async function loadCompetitorData() {
        try {
            const response = await fetch(`${API_BASE}/api/admin-data?type=competitors`);
            const result = await response.json();

            if (result.success) {
                const chrisDavid = result.data.competitors.find(c =>
                    c.isOurSalon || c.name.toLowerCase().includes('chris david')
                );
                if (chrisDavid) {
                    document.getElementById('currentReviews').textContent = chrisDavid.reviews || '--';
                    document.getElementById('currentRating').textContent = chrisDavid.rating || '--';
                }
            }
        } catch (error) {
            console.error('Competitor data error:', error);
        }
    }

    function renderMissedOpportunities() {
        const container = document.getElementById('missedOpportunities');
        const opportunities = keywordsData
            .filter(k => parseFloat(k.position) > 10 && parseInt(k.impressions) > 10)
            .sort((a, b) => parseInt(b.impressions) - parseInt(a.impressions))
            .slice(0, 5);

        if (opportunities.length === 0) {
            container.innerHTML = '<div class="text-green-600">No major missed opportunities found!</div>';
            return;
        }

        container.innerHTML = opportunities.map(k => `
            <div class="flex justify-between items-center py-2 px-3 bg-white rounded border">
                <span class="font-medium">"${k.keyword}"</span>
                <div class="flex items-center gap-4 text-sm">
                    <span class="text-gray-500">${k.impressions} impressions</span>
                    <span class="text-red-600 font-semibold">Position #${k.position}</span>
                </div>
            </div>
        `).join('');
    }

    function renderKeywordCategories() {
        // Winning (position 1-3)
        const winning = keywordsData.filter(k => parseFloat(k.position) <= 3);
        document.getElementById('winningKeywords').innerHTML = winning.length > 0
            ? winning.slice(0, 5).map(k => `
                <div class="text-sm py-1 px-2 bg-green-50 rounded">
                    "${k.keyword}" <span class="text-green-600">#${k.position}</span>
                </div>
            `).join('')
            : '<div class="text-gray-400 text-sm">None yet - that\'s the goal!</div>';

        // Almost there (position 4-10)
        const almost = keywordsData.filter(k => parseFloat(k.position) > 3 && parseFloat(k.position) <= 10);
        document.getElementById('almostKeywords').innerHTML = almost.length > 0
            ? almost.slice(0, 5).map(k => `
                <div class="text-sm py-1 px-2 bg-yellow-50 rounded">
                    "${k.keyword}" <span class="text-yellow-600">#${k.position}</span>
                </div>
            `).join('')
            : '<div class="text-gray-400 text-sm">None in this range</div>';

        // Opportunities (position 11+)
        const opportunities = keywordsData
            .filter(k => parseFloat(k.position) > 10)
            .sort((a, b) => parseInt(b.impressions) - parseInt(a.impressions));
        document.getElementById('opportunityKeywords').innerHTML = opportunities.length > 0
            ? opportunities.slice(0, 5).map(k => `
                <div class="text-sm py-1 px-2 bg-orange-50 rounded">
                    "${k.keyword}" <span class="text-orange-600">#${k.position}</span>
                </div>
            `).join('')
            : '<div class="text-gray-400 text-sm">None - you\'re doing great!</div>';
    }

    function renderPriorityActions() {
        const container = document.getElementById('priorityActions');

        // Find top opportunities
        const topOpps = keywordsData
            .filter(k => parseFloat(k.position) > 10 && parseInt(k.impressions) > 20)
            .sort((a, b) => parseInt(b.impressions) - parseInt(a.impressions))
            .slice(0, 3);

        const actions = [];

        // Action 1: Always optimize GBP
        actions.push({
            priority: 1,
            title: 'Optimize Google Business Profile',
            description: 'Complete ALL fields, add 20+ photos, post weekly. GBP is 25-30% of local rankings.',
            impact: 'HIGH',
            effort: 'MEDIUM',
            link: 'https://business.google.com',
            linkText: 'Edit Profile'
        });

        // Action 2: Based on top opportunity
        if (topOpps.length > 0) {
            const topOpp = topOpps[0];
            actions.push({
                priority: 2,
                title: `Create landing page for "${topOpp.keyword}"`,
                description: `You're showing up ${topOpp.impressions} times but at position ${topOpp.position}. A dedicated page could capture this traffic.`,
                impact: 'HIGH',
                effort: 'MEDIUM',
                keyword: topOpp.keyword
            });
        }

        // Action 3: Reviews
        actions.push({
            priority: 3,
            title: 'Generate 10+ new Google reviews',
            description: 'Reviews are 15-20% of ranking. Ask every satisfied client. Respond to all reviews within 24 hours.',
            impact: 'HIGH',
            effort: 'LOW',
            link: 'https://search.google.com/local/writereview?placeid=ChIJxTZ8If_f2IgR2XMxX_zRKSg',
            linkText: 'Review Link'
        });

        // Action 4: Optimize balayage page if relevant
        const balayage = keywordsData.find(k => k.keyword.includes('balayage') && parseFloat(k.position) > 3);
        if (balayage) {
            actions.push({
                priority: 4,
                title: 'Optimize "Balayage Delray Beach" page',
                description: `Currently position ${balayage.position} with ${balayage.impressions} impressions. Add more content, before/after photos, testimonials.`,
                impact: 'MEDIUM',
                effort: 'LOW'
            });
        }

        container.innerHTML = actions.map((a, i) => `
            <div class="bg-white rounded-lg p-4 border-2 ${i === 0 ? 'border-green-300' : 'border-gray-200'}">
                <div class="flex items-start justify-between">
                    <div class="flex items-start gap-3">
                        <div class="w-8 h-8 rounded-full bg-green-500 text-white flex items-center justify-center font-bold flex-shrink-0">
                            ${a.priority}
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800">${a.title}</h4>
                            <p class="text-sm text-gray-600 mt-1">${a.description}</p>
                            ${a.link ? `
                                <a href="${a.link}" target="_blank" class="inline-block mt-2 text-sm text-blue-600 hover:text-blue-800">
                                    <i class="fas fa-external-link-alt mr-1"></i>${a.linkText}
                                </a>
                            ` : ''}
                        </div>
                    </div>
                    <div class="flex flex-col items-end gap-1">
                        <span class="text-xs px-2 py-1 ${a.impact === 'HIGH' ? 'bg-red-100 text-red-700' : 'bg-yellow-100 text-yellow-700'} rounded font-semibold">
                            ${a.impact} IMPACT
                        </span>
                        <span class="text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded">
                            ${a.effort} effort
                        </span>
                    </div>
                </div>
            </div>
        `).join('');
    }

    function renderSuggestedPages() {
        const container = document.getElementById('suggestedPages');

        // Find keywords that need new pages
        const needsPages = keywordsData
            .filter(k => {
                const pos = parseFloat(k.position);
                const impressions = parseInt(k.impressions);
                // High impressions, poor ranking, not already a service page
                return pos > 15 && impressions > 15 &&
                    !k.keyword.includes('chris david') &&
                    !k.keyword.includes('review');
            })
            .sort((a, b) => parseInt(b.impressions) - parseInt(a.impressions))
            .slice(0, 4);

        // Also add some strategic recommendations
        const suggestions = [
            ...needsPages.map(k => ({
                keyword: k.keyword,
                url: `/services/${k.keyword.replace(/\s+/g, '-').toLowerCase()}.html`,
                reason: `${k.impressions} impressions at position ${k.position}`,
                fromData: true
            })),
            {
                keyword: 'best hair salon delray beach',
                url: '/best-hair-salon-delray-beach.html',
                reason: 'High-value competitive keyword',
                fromData: false
            },
            {
                keyword: 'hair colorist delray beach',
                url: '/hair-colorist-delray-beach.html',
                reason: 'Chris\'s specialty - differentiation',
                fromData: false
            }
        ];

        // Remove duplicates
        const uniqueSuggestions = suggestions.filter((s, i, arr) =>
            arr.findIndex(x => x.keyword === s.keyword) === i
        ).slice(0, 6);

        container.innerHTML = uniqueSuggestions.map(s => `
            <div class="bg-white rounded-lg p-4 border ${s.fromData ? 'border-blue-200' : 'border-gray-200'}">
                <div class="flex items-start justify-between mb-2">
                    <h4 class="font-semibold text-gray-800">"${s.keyword}"</h4>
                    ${s.fromData ? '<span class="text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded">From your data</span>' : ''}
                </div>
                <p class="text-sm text-gray-600 mb-2">${s.reason}</p>
                <code class="text-xs bg-gray-100 px-2 py-1 rounded text-gray-600">${s.url}</code>
            </div>
        `).join('');
    }

    function renderQuickWins() {
        const container = document.getElementById('quickWins');
        const wins = [
            { task: 'Add "Delray Beach" to all page titles', impact: 'Location relevance' },
            { task: 'Add alt text to all images with keywords', impact: 'Image SEO' },
            { task: 'Create internal links between service pages', impact: 'Link equity' },
            { task: 'Add FAQ section with schema markup', impact: 'Rich snippets' },
            { task: 'Speed up page load (compress images)', impact: 'Core Web Vitals' },
            { task: 'Add "Call Now" button above the fold', impact: 'Conversions' }
        ];

        container.innerHTML = wins.map(w => `
            <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
                <input type="checkbox" class="w-5 h-5 rounded border-gray-300 text-purple-600">
                <div class="flex-1">
                    <div class="font-medium text-gray-800">${w.task}</div>
                    <div class="text-xs text-gray-500">${w.impact}</div>
                </div>
            </div>
        `).join('');
    }

    // Initialize
    loadAllData();
    </script>
</body>
</html>
